{
  "config": {
    "size": "large",
    "language": "english",
    "seed": 137,
    "d_model": 128,
    "n_layer": 3,
    "n_head": 4,
    "dropout": 0.15,
    "ctx_len": 256,
    "batch_size": 64,
    "max_steps": 10000,
    "lr": 0.0003,
    "weight_decay": 0.1,
    "grad_clip": 1.0,
    "warmup_steps": 100,
    "patience": 10001,
    "eval_interval": 100,
    "num_samples": 50,
    "prompt_len": 32,
    "gen_len": 128,
    "temperature": 0.8,
    "top_k": 40,
    "lcs_threshold": 50
  },
  "training": {
    "n_params": 758912,
    "vocab_size": 1024,
    "total_time_s": 647.2,
    "total_steps": 10000,
    "best_step": 800,
    "best_val_loss": 2.2557,
    "best_val_bpc": 3.2543,
    "final_train_loss": 1.4114,
    "early_stopped": false,
    "bpc_thresholds_reached": {},
    "log": [
      {
        "step": 1,
        "train_loss": 6.9664,
        "val_loss": 6.9697,
        "train_bpc": 10.0503,
        "val_bpc": 10.0552
      },
      {
        "step": 100,
        "train_loss": 4.6539,
        "val_loss": 4.2251,
        "train_bpc": 6.7141,
        "val_bpc": 6.0955
      },
      {
        "step": 200,
        "train_loss": 2.3362,
        "val_loss": 2.6362,
        "train_bpc": 3.3705,
        "val_bpc": 3.8032
      },
      {
        "step": 300,
        "train_loss": 1.9186,
        "val_loss": 2.4877,
        "train_bpc": 2.768,
        "val_bpc": 3.589
      },
      {
        "step": 400,
        "train_loss": 2.161,
        "val_loss": 2.4597,
        "train_bpc": 3.1176,
        "val_bpc": 3.5486
      },
      {
        "step": 500,
        "train_loss": 2.2224,
        "val_loss": 2.4413,
        "train_bpc": 3.2063,
        "val_bpc": 3.522
      },
      {
        "step": 600,
        "train_loss": 2.0916,
        "val_loss": 2.3743,
        "train_bpc": 3.0176,
        "val_bpc": 3.4254
      },
      {
        "step": 700,
        "train_loss": 1.9922,
        "val_loss": 2.3776,
        "train_bpc": 2.8741,
        "val_bpc": 3.4301
      },
      {
        "step": 800,
        "train_loss": 1.636,
        "val_loss": 2.2557,
        "train_bpc": 2.3603,
        "val_bpc": 3.2543
      },
      {
        "step": 900,
        "train_loss": 1.9556,
        "val_loss": 2.2641,
        "train_bpc": 2.8213,
        "val_bpc": 3.2664
      },
      {
        "step": 1000,
        "train_loss": 1.7274,
        "val_loss": 2.2764,
        "train_bpc": 2.4921,
        "val_bpc": 3.2842
      },
      {
        "step": 1100,
        "train_loss": 1.8026,
        "val_loss": 2.2879,
        "train_bpc": 2.6006,
        "val_bpc": 3.3008
      },
      {
        "step": 1200,
        "train_loss": 1.8209,
        "val_loss": 2.2619,
        "train_bpc": 2.627,
        "val_bpc": 3.2632
      },
      {
        "step": 1300,
        "train_loss": 1.9309,
        "val_loss": 2.2859,
        "train_bpc": 2.7857,
        "val_bpc": 3.2979
      },
      {
        "step": 1400,
        "train_loss": 1.5091,
        "val_loss": 2.3546,
        "train_bpc": 2.1771,
        "val_bpc": 3.397
      },
      {
        "step": 1500,
        "train_loss": 1.8306,
        "val_loss": 2.3757,
        "train_bpc": 2.641,
        "val_bpc": 3.4274
      },
      {
        "step": 1600,
        "train_loss": 1.7593,
        "val_loss": 2.4428,
        "train_bpc": 2.5382,
        "val_bpc": 3.5242
      },
      {
        "step": 1700,
        "train_loss": 1.68,
        "val_loss": 2.3906,
        "train_bpc": 2.4238,
        "val_bpc": 3.4488
      },
      {
        "step": 1800,
        "train_loss": 1.7896,
        "val_loss": 2.4662,
        "train_bpc": 2.5819,
        "val_bpc": 3.558
      },
      {
        "step": 1900,
        "train_loss": 1.5494,
        "val_loss": 2.4379,
        "train_bpc": 2.2353,
        "val_bpc": 3.5172
      },
      {
        "step": 2000,
        "train_loss": 1.6379,
        "val_loss": 2.4785,
        "train_bpc": 2.363,
        "val_bpc": 3.5758
      },
      {
        "step": 2100,
        "train_loss": 1.482,
        "val_loss": 2.4821,
        "train_bpc": 2.1381,
        "val_bpc": 3.5809
      },
      {
        "step": 2200,
        "train_loss": 1.4218,
        "val_loss": 2.4569,
        "train_bpc": 2.0513,
        "val_bpc": 3.5445
      },
      {
        "step": 2300,
        "train_loss": 1.5146,
        "val_loss": 2.4414,
        "train_bpc": 2.1851,
        "val_bpc": 3.5223
      },
      {
        "step": 2400,
        "train_loss": 1.4268,
        "val_loss": 2.4293,
        "train_bpc": 2.0584,
        "val_bpc": 3.5048
      },
      {
        "step": 2500,
        "train_loss": 1.3713,
        "val_loss": 2.3691,
        "train_bpc": 1.9783,
        "val_bpc": 3.418
      },
      {
        "step": 2600,
        "train_loss": 1.5518,
        "val_loss": 2.3841,
        "train_bpc": 2.2388,
        "val_bpc": 3.4396
      },
      {
        "step": 2700,
        "train_loss": 1.6274,
        "val_loss": 2.4263,
        "train_bpc": 2.3478,
        "val_bpc": 3.5004
      },
      {
        "step": 2800,
        "train_loss": 1.3765,
        "val_loss": 2.4486,
        "train_bpc": 1.9858,
        "val_bpc": 3.5326
      },
      {
        "step": 2900,
        "train_loss": 1.4198,
        "val_loss": 2.4185,
        "train_bpc": 2.0483,
        "val_bpc": 3.4891
      },
      {
        "step": 3000,
        "train_loss": 1.4216,
        "val_loss": 2.4493,
        "train_bpc": 2.0509,
        "val_bpc": 3.5337
      },
      {
        "step": 3100,
        "train_loss": 1.1923,
        "val_loss": 2.4307,
        "train_bpc": 1.7202,
        "val_bpc": 3.5067
      },
      {
        "step": 3200,
        "train_loss": 1.5216,
        "val_loss": 2.4641,
        "train_bpc": 2.1952,
        "val_bpc": 3.555
      },
      {
        "step": 3300,
        "train_loss": 1.5386,
        "val_loss": 2.4687,
        "train_bpc": 2.2197,
        "val_bpc": 3.5616
      },
      {
        "step": 3400,
        "train_loss": 1.5815,
        "val_loss": 2.3986,
        "train_bpc": 2.2817,
        "val_bpc": 3.4605
      },
      {
        "step": 3500,
        "train_loss": 1.5778,
        "val_loss": 2.4435,
        "train_bpc": 2.2763,
        "val_bpc": 3.5252
      },
      {
        "step": 3600,
        "train_loss": 1.6463,
        "val_loss": 2.4852,
        "train_bpc": 2.3752,
        "val_bpc": 3.5854
      },
      {
        "step": 3700,
        "train_loss": 1.3946,
        "val_loss": 2.5042,
        "train_bpc": 2.012,
        "val_bpc": 3.6127
      },
      {
        "step": 3800,
        "train_loss": 1.4972,
        "val_loss": 2.5166,
        "train_bpc": 2.1599,
        "val_bpc": 3.6307
      },
      {
        "step": 3900,
        "train_loss": 1.3818,
        "val_loss": 2.5692,
        "train_bpc": 1.9935,
        "val_bpc": 3.7066
      },
      {
        "step": 4000,
        "train_loss": 1.2737,
        "val_loss": 2.4417,
        "train_bpc": 1.8375,
        "val_bpc": 3.5226
      },
      {
        "step": 4100,
        "train_loss": 1.1227,
        "val_loss": 2.4215,
        "train_bpc": 1.6197,
        "val_bpc": 3.4934
      },
      {
        "step": 4200,
        "train_loss": 1.2432,
        "val_loss": 2.4768,
        "train_bpc": 1.7936,
        "val_bpc": 3.5733
      },
      {
        "step": 4300,
        "train_loss": 1.3106,
        "val_loss": 2.5304,
        "train_bpc": 1.8908,
        "val_bpc": 3.6505
      },
      {
        "step": 4400,
        "train_loss": 1.1331,
        "val_loss": 2.4387,
        "train_bpc": 1.6347,
        "val_bpc": 3.5182
      },
      {
        "step": 4500,
        "train_loss": 1.4608,
        "val_loss": 2.5058,
        "train_bpc": 2.1076,
        "val_bpc": 3.6151
      },
      {
        "step": 4600,
        "train_loss": 1.6031,
        "val_loss": 2.4712,
        "train_bpc": 2.3128,
        "val_bpc": 3.5652
      },
      {
        "step": 4700,
        "train_loss": 1.3589,
        "val_loss": 2.5308,
        "train_bpc": 1.9605,
        "val_bpc": 3.6512
      },
      {
        "step": 4800,
        "train_loss": 1.5607,
        "val_loss": 2.4621,
        "train_bpc": 2.2516,
        "val_bpc": 3.5521
      },
      {
        "step": 4900,
        "train_loss": 1.363,
        "val_loss": 2.5133,
        "train_bpc": 1.9665,
        "val_bpc": 3.626
      },
      {
        "step": 5000,
        "train_loss": 1.2353,
        "val_loss": 2.5321,
        "train_bpc": 1.7822,
        "val_bpc": 3.6531
      },
      {
        "step": 5100,
        "train_loss": 1.1799,
        "val_loss": 2.5092,
        "train_bpc": 1.7023,
        "val_bpc": 3.6201
      },
      {
        "step": 5200,
        "train_loss": 1.1151,
        "val_loss": 2.4704,
        "train_bpc": 1.6088,
        "val_bpc": 3.564
      },
      {
        "step": 5300,
        "train_loss": 1.3576,
        "val_loss": 2.4879,
        "train_bpc": 1.9586,
        "val_bpc": 3.5893
      },
      {
        "step": 5400,
        "train_loss": 1.2593,
        "val_loss": 2.4903,
        "train_bpc": 1.8168,
        "val_bpc": 3.5928
      },
      {
        "step": 5500,
        "train_loss": 1.1903,
        "val_loss": 2.4832,
        "train_bpc": 1.7172,
        "val_bpc": 3.5825
      },
      {
        "step": 5600,
        "train_loss": 1.2918,
        "val_loss": 2.4371,
        "train_bpc": 1.8637,
        "val_bpc": 3.516
      },
      {
        "step": 5700,
        "train_loss": 1.2138,
        "val_loss": 2.4746,
        "train_bpc": 1.7512,
        "val_bpc": 3.5702
      },
      {
        "step": 5800,
        "train_loss": 1.3826,
        "val_loss": 2.4449,
        "train_bpc": 1.9946,
        "val_bpc": 3.5272
      },
      {
        "step": 5900,
        "train_loss": 1.2669,
        "val_loss": 2.5476,
        "train_bpc": 1.8277,
        "val_bpc": 3.6754
      },
      {
        "step": 6000,
        "train_loss": 1.4071,
        "val_loss": 2.4768,
        "train_bpc": 2.03,
        "val_bpc": 3.5733
      },
      {
        "step": 6100,
        "train_loss": 1.5098,
        "val_loss": 2.5577,
        "train_bpc": 2.1782,
        "val_bpc": 3.6899
      },
      {
        "step": 6200,
        "train_loss": 1.391,
        "val_loss": 2.5358,
        "train_bpc": 2.0068,
        "val_bpc": 3.6584
      },
      {
        "step": 6300,
        "train_loss": 1.3385,
        "val_loss": 2.5291,
        "train_bpc": 1.9311,
        "val_bpc": 3.6487
      },
      {
        "step": 6400,
        "train_loss": 1.2031,
        "val_loss": 2.5623,
        "train_bpc": 1.7358,
        "val_bpc": 3.6967
      },
      {
        "step": 6500,
        "train_loss": 1.3323,
        "val_loss": 2.5362,
        "train_bpc": 1.9221,
        "val_bpc": 3.6589
      },
      {
        "step": 6600,
        "train_loss": 1.646,
        "val_loss": 2.5627,
        "train_bpc": 2.3746,
        "val_bpc": 3.6972
      },
      {
        "step": 6700,
        "train_loss": 1.0911,
        "val_loss": 2.5615,
        "train_bpc": 1.5742,
        "val_bpc": 3.6955
      },
      {
        "step": 6800,
        "train_loss": 1.3486,
        "val_loss": 2.5575,
        "train_bpc": 1.9456,
        "val_bpc": 3.6897
      },
      {
        "step": 6900,
        "train_loss": 1.4304,
        "val_loss": 2.5706,
        "train_bpc": 2.0637,
        "val_bpc": 3.7086
      },
      {
        "step": 7000,
        "train_loss": 1.3045,
        "val_loss": 2.5884,
        "train_bpc": 1.8819,
        "val_bpc": 3.7342
      },
      {
        "step": 7100,
        "train_loss": 1.368,
        "val_loss": 2.5428,
        "train_bpc": 1.9737,
        "val_bpc": 3.6685
      },
      {
        "step": 7200,
        "train_loss": 1.3083,
        "val_loss": 2.5537,
        "train_bpc": 1.8875,
        "val_bpc": 3.6843
      },
      {
        "step": 7300,
        "train_loss": 1.2996,
        "val_loss": 2.5672,
        "train_bpc": 1.8749,
        "val_bpc": 3.7037
      },
      {
        "step": 7400,
        "train_loss": 1.221,
        "val_loss": 2.5581,
        "train_bpc": 1.7615,
        "val_bpc": 3.6906
      },
      {
        "step": 7500,
        "train_loss": 1.4591,
        "val_loss": 2.5989,
        "train_bpc": 2.105,
        "val_bpc": 3.7494
      },
      {
        "step": 7600,
        "train_loss": 1.0697,
        "val_loss": 2.5506,
        "train_bpc": 1.5433,
        "val_bpc": 3.6798
      },
      {
        "step": 7700,
        "train_loss": 1.2872,
        "val_loss": 2.6126,
        "train_bpc": 1.857,
        "val_bpc": 3.7692
      },
      {
        "step": 7800,
        "train_loss": 1.4639,
        "val_loss": 2.5885,
        "train_bpc": 2.112,
        "val_bpc": 3.7344
      },
      {
        "step": 7900,
        "train_loss": 1.2304,
        "val_loss": 2.5844,
        "train_bpc": 1.775,
        "val_bpc": 3.7284
      },
      {
        "step": 8000,
        "train_loss": 1.3338,
        "val_loss": 2.5773,
        "train_bpc": 1.9243,
        "val_bpc": 3.7183
      },
      {
        "step": 8100,
        "train_loss": 1.2517,
        "val_loss": 2.5788,
        "train_bpc": 1.8059,
        "val_bpc": 3.7204
      },
      {
        "step": 8200,
        "train_loss": 1.3205,
        "val_loss": 2.5708,
        "train_bpc": 1.905,
        "val_bpc": 3.7089
      },
      {
        "step": 8300,
        "train_loss": 1.2277,
        "val_loss": 2.5653,
        "train_bpc": 1.7712,
        "val_bpc": 3.7009
      },
      {
        "step": 8400,
        "train_loss": 1.3126,
        "val_loss": 2.5844,
        "train_bpc": 1.8937,
        "val_bpc": 3.7284
      },
      {
        "step": 8500,
        "train_loss": 1.3857,
        "val_loss": 2.5922,
        "train_bpc": 1.9992,
        "val_bpc": 3.7397
      },
      {
        "step": 8600,
        "train_loss": 1.3234,
        "val_loss": 2.5954,
        "train_bpc": 1.9093,
        "val_bpc": 3.7444
      },
      {
        "step": 8700,
        "train_loss": 1.0912,
        "val_loss": 2.582,
        "train_bpc": 1.5742,
        "val_bpc": 3.7251
      },
      {
        "step": 8800,
        "train_loss": 1.3266,
        "val_loss": 2.5834,
        "train_bpc": 1.9138,
        "val_bpc": 3.7271
      },
      {
        "step": 8900,
        "train_loss": 1.2594,
        "val_loss": 2.5779,
        "train_bpc": 1.817,
        "val_bpc": 3.7191
      },
      {
        "step": 9000,
        "train_loss": 1.2678,
        "val_loss": 2.5863,
        "train_bpc": 1.829,
        "val_bpc": 3.7313
      },
      {
        "step": 9100,
        "train_loss": 0.9564,
        "val_loss": 2.5794,
        "train_bpc": 1.3798,
        "val_bpc": 3.7214
      },
      {
        "step": 9200,
        "train_loss": 1.6493,
        "val_loss": 2.5811,
        "train_bpc": 2.3794,
        "val_bpc": 3.7238
      },
      {
        "step": 9300,
        "train_loss": 1.2882,
        "val_loss": 2.5866,
        "train_bpc": 1.8585,
        "val_bpc": 3.7316
      },
      {
        "step": 9400,
        "train_loss": 1.1621,
        "val_loss": 2.5762,
        "train_bpc": 1.6766,
        "val_bpc": 3.7167
      },
      {
        "step": 9500,
        "train_loss": 1.3635,
        "val_loss": 2.5746,
        "train_bpc": 1.967,
        "val_bpc": 3.7143
      },
      {
        "step": 9600,
        "train_loss": 1.2113,
        "val_loss": 2.5751,
        "train_bpc": 1.7475,
        "val_bpc": 3.715
      },
      {
        "step": 9700,
        "train_loss": 1.2,
        "val_loss": 2.5742,
        "train_bpc": 1.7312,
        "val_bpc": 3.7138
      },
      {
        "step": 9800,
        "train_loss": 1.4221,
        "val_loss": 2.5763,
        "train_bpc": 2.0516,
        "val_bpc": 3.7167
      },
      {
        "step": 9900,
        "train_loss": 1.2672,
        "val_loss": 2.5774,
        "train_bpc": 1.8282,
        "val_bpc": 3.7184
      },
      {
        "step": 10000,
        "train_loss": 1.4114,
        "val_loss": 2.5776,
        "train_bpc": 2.0362,
        "val_bpc": 3.7187
      }
    ],
    "train_chars": {
      "narrative": 407194,
      "babi": 2390610,
      "total": 2797806
    }
  },
  "babi": {
    "test_seen": {
      "task01": {
        "accuracy": 0.065,
        "correct": 13,
        "total": 200
      },
      "task02": {
        "accuracy": 0.1,
        "correct": 20,
        "total": 200
      },
      "task03": {
        "accuracy": 0.05,
        "correct": 10,
        "total": 200
      },
      "task04": {
        "accuracy": 0.09,
        "correct": 18,
        "total": 200
      },
      "task05": {
        "accuracy": 0.105,
        "correct": 21,
        "total": 200
      },
      "task06": {
        "accuracy": 0.495,
        "correct": 99,
        "total": 200
      },
      "task07": {
        "accuracy": 0.41,
        "correct": 82,
        "total": 200
      },
      "task08": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task09": {
        "accuracy": 0.5,
        "correct": 100,
        "total": 200
      },
      "task10": {
        "accuracy": 0.3,
        "correct": 60,
        "total": 200
      },
      "task11": {
        "accuracy": 0.12,
        "correct": 24,
        "total": 200
      },
      "task12": {
        "accuracy": 0.08,
        "correct": 16,
        "total": 200
      },
      "task13": {
        "accuracy": 0.075,
        "correct": 15,
        "total": 200
      },
      "task14": {
        "accuracy": 0.095,
        "correct": 19,
        "total": 200
      },
      "task15": {
        "accuracy": 0.07,
        "correct": 14,
        "total": 200
      },
      "task16": {
        "accuracy": 0.25,
        "correct": 50,
        "total": 200
      },
      "task17": {
        "accuracy": 0.64,
        "correct": 128,
        "total": 200
      },
      "task18": {
        "accuracy": 0.68,
        "correct": 136,
        "total": 200
      },
      "task19": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task20": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "overall": {
        "accuracy": 0.2062,
        "correct": 825,
        "total": 4000
      }
    },
    "test_unseen": {
      "task01": {
        "accuracy": 0.05,
        "correct": 10,
        "total": 200
      },
      "task02": {
        "accuracy": 0.03,
        "correct": 6,
        "total": 200
      },
      "task03": {
        "accuracy": 0.06,
        "correct": 12,
        "total": 200
      },
      "task04": {
        "accuracy": 0.035,
        "correct": 7,
        "total": 200
      },
      "task05": {
        "accuracy": 0.03,
        "correct": 6,
        "total": 200
      },
      "task06": {
        "accuracy": 0.565,
        "correct": 113,
        "total": 200
      },
      "task07": {
        "accuracy": 0.325,
        "correct": 65,
        "total": 200
      },
      "task08": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task09": {
        "accuracy": 0.43,
        "correct": 86,
        "total": 200
      },
      "task10": {
        "accuracy": 0.39,
        "correct": 78,
        "total": 200
      },
      "task11": {
        "accuracy": 0.05,
        "correct": 10,
        "total": 200
      },
      "task12": {
        "accuracy": 0.035,
        "correct": 7,
        "total": 200
      },
      "task13": {
        "accuracy": 0.055,
        "correct": 11,
        "total": 200
      },
      "task14": {
        "accuracy": 0.05,
        "correct": 10,
        "total": 200
      },
      "task15": {
        "accuracy": 0.06,
        "correct": 12,
        "total": 200
      },
      "task16": {
        "accuracy": 0.12,
        "correct": 24,
        "total": 200
      },
      "task17": {
        "accuracy": 0.455,
        "correct": 91,
        "total": 200
      },
      "task18": {
        "accuracy": 0.54,
        "correct": 108,
        "total": 200
      },
      "task19": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task20": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "overall": {
        "accuracy": 0.164,
        "correct": 656,
        "total": 4000
      }
    }
  },
  "test_bpc": {
    "test_bpc": 2.6127,
    "test_chars_evaluated": 120813
  },
  "val_bpc": 3.2543,
  "memorization": {
    "n_memorized": 0,
    "n_novel": 50,
    "avg_lcs": 15.9,
    "threshold": 50
  },
  "grammar": {
    "total_sentences": 816,
    "error_free": 809,
    "grammaticality_rate": 0.9914,
    "avg_grammar_errors": 0.0086,
    "novel_only": true,
    "n_samples_evaluated": 50
  },
  "structural": {
    "char_kl_divergence": 0.088093,
    "ngram_diversity_3": 0.0618,
    "ngram_diversity_4": 0.1139,
    "ngram_diversity_5": 0.1594,
    "repetition_rate_10": 0.6394,
    "repetition_rate_20": 0.2766,
    "repetition_rate_50": 0.0007,
    "word_length_similarity": 0.8623
  }
}