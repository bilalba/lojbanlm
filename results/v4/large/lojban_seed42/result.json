{
  "config": {
    "size": "large",
    "language": "lojban",
    "seed": 42,
    "d_model": 128,
    "n_layer": 3,
    "n_head": 4,
    "dropout": 0.15,
    "ctx_len": 256,
    "batch_size": 64,
    "max_steps": 10000,
    "lr": 0.0003,
    "weight_decay": 0.1,
    "grad_clip": 1.0,
    "warmup_steps": 100,
    "patience": 10001,
    "eval_interval": 100,
    "num_samples": 50,
    "prompt_len": 32,
    "gen_len": 128,
    "temperature": 0.8,
    "top_k": 40,
    "lcs_threshold": 50
  },
  "training": {
    "n_params": 758912,
    "vocab_size": 1024,
    "total_time_s": 624.5,
    "total_steps": 10000,
    "best_step": 300,
    "best_val_loss": 2.1783,
    "best_val_bpc": 3.1427,
    "final_train_loss": 1.0519,
    "early_stopped": false,
    "bpc_thresholds_reached": {},
    "log": [
      {
        "step": 1,
        "train_loss": 6.9624,
        "val_loss": 6.9389,
        "train_bpc": 10.0447,
        "val_bpc": 10.0107
      },
      {
        "step": 100,
        "train_loss": 4.2172,
        "val_loss": 4.3074,
        "train_bpc": 6.0842,
        "val_bpc": 6.2143
      },
      {
        "step": 200,
        "train_loss": 2.274,
        "val_loss": 2.4602,
        "train_bpc": 3.2806,
        "val_bpc": 3.5493
      },
      {
        "step": 300,
        "train_loss": 1.5191,
        "val_loss": 2.1783,
        "train_bpc": 2.1915,
        "val_bpc": 3.1427
      },
      {
        "step": 400,
        "train_loss": 1.8316,
        "val_loss": 2.2572,
        "train_bpc": 2.6425,
        "val_bpc": 3.2565
      },
      {
        "step": 500,
        "train_loss": 1.33,
        "val_loss": 2.3037,
        "train_bpc": 1.9188,
        "val_bpc": 3.3235
      },
      {
        "step": 600,
        "train_loss": 1.3383,
        "val_loss": 2.3506,
        "train_bpc": 1.9307,
        "val_bpc": 3.3912
      },
      {
        "step": 700,
        "train_loss": 1.7,
        "val_loss": 2.3292,
        "train_bpc": 2.4526,
        "val_bpc": 3.3603
      },
      {
        "step": 800,
        "train_loss": 1.4601,
        "val_loss": 2.3558,
        "train_bpc": 2.1065,
        "val_bpc": 3.3988
      },
      {
        "step": 900,
        "train_loss": 1.2639,
        "val_loss": 2.3898,
        "train_bpc": 1.8234,
        "val_bpc": 3.4478
      },
      {
        "step": 1000,
        "train_loss": 1.2523,
        "val_loss": 2.4024,
        "train_bpc": 1.8066,
        "val_bpc": 3.4659
      },
      {
        "step": 1100,
        "train_loss": 1.3169,
        "val_loss": 2.4539,
        "train_bpc": 1.9,
        "val_bpc": 3.5403
      },
      {
        "step": 1200,
        "train_loss": 1.3696,
        "val_loss": 2.4647,
        "train_bpc": 1.976,
        "val_bpc": 3.5559
      },
      {
        "step": 1300,
        "train_loss": 1.1738,
        "val_loss": 2.5115,
        "train_bpc": 1.6935,
        "val_bpc": 3.6234
      },
      {
        "step": 1400,
        "train_loss": 1.4056,
        "val_loss": 2.5289,
        "train_bpc": 2.0278,
        "val_bpc": 3.6484
      },
      {
        "step": 1500,
        "train_loss": 1.2804,
        "val_loss": 2.5381,
        "train_bpc": 1.8472,
        "val_bpc": 3.6617
      },
      {
        "step": 1600,
        "train_loss": 1.1942,
        "val_loss": 2.5427,
        "train_bpc": 1.7228,
        "val_bpc": 3.6683
      },
      {
        "step": 1700,
        "train_loss": 0.9975,
        "val_loss": 2.5377,
        "train_bpc": 1.4392,
        "val_bpc": 3.6611
      },
      {
        "step": 1800,
        "train_loss": 1.0504,
        "val_loss": 2.5652,
        "train_bpc": 1.5155,
        "val_bpc": 3.7008
      },
      {
        "step": 1900,
        "train_loss": 1.3085,
        "val_loss": 2.5262,
        "train_bpc": 1.8877,
        "val_bpc": 3.6446
      },
      {
        "step": 2000,
        "train_loss": 1.1432,
        "val_loss": 2.5631,
        "train_bpc": 1.6492,
        "val_bpc": 3.6978
      },
      {
        "step": 2100,
        "train_loss": 1.0715,
        "val_loss": 2.5625,
        "train_bpc": 1.5458,
        "val_bpc": 3.6969
      },
      {
        "step": 2200,
        "train_loss": 1.1067,
        "val_loss": 2.5485,
        "train_bpc": 1.5967,
        "val_bpc": 3.6767
      },
      {
        "step": 2300,
        "train_loss": 1.1355,
        "val_loss": 2.5795,
        "train_bpc": 1.6381,
        "val_bpc": 3.7215
      },
      {
        "step": 2400,
        "train_loss": 1.104,
        "val_loss": 2.5347,
        "train_bpc": 1.5928,
        "val_bpc": 3.6567
      },
      {
        "step": 2500,
        "train_loss": 1.1155,
        "val_loss": 2.5063,
        "train_bpc": 1.6094,
        "val_bpc": 3.6159
      },
      {
        "step": 2600,
        "train_loss": 1.1016,
        "val_loss": 2.4852,
        "train_bpc": 1.5892,
        "val_bpc": 3.5855
      },
      {
        "step": 2700,
        "train_loss": 1.1653,
        "val_loss": 2.5745,
        "train_bpc": 1.6812,
        "val_bpc": 3.7143
      },
      {
        "step": 2800,
        "train_loss": 1.0068,
        "val_loss": 2.6375,
        "train_bpc": 1.4525,
        "val_bpc": 3.8051
      },
      {
        "step": 2900,
        "train_loss": 0.8693,
        "val_loss": 2.5361,
        "train_bpc": 1.2542,
        "val_bpc": 3.6588
      },
      {
        "step": 3000,
        "train_loss": 1.1356,
        "val_loss": 2.5201,
        "train_bpc": 1.6383,
        "val_bpc": 3.6357
      },
      {
        "step": 3100,
        "train_loss": 0.9279,
        "val_loss": 2.5049,
        "train_bpc": 1.3387,
        "val_bpc": 3.6138
      },
      {
        "step": 3200,
        "train_loss": 1.0809,
        "val_loss": 2.4984,
        "train_bpc": 1.5594,
        "val_bpc": 3.6044
      },
      {
        "step": 3300,
        "train_loss": 1.1455,
        "val_loss": 2.4747,
        "train_bpc": 1.6526,
        "val_bpc": 3.5702
      },
      {
        "step": 3400,
        "train_loss": 0.9494,
        "val_loss": 2.4178,
        "train_bpc": 1.3696,
        "val_bpc": 3.4882
      },
      {
        "step": 3500,
        "train_loss": 1.0387,
        "val_loss": 2.5223,
        "train_bpc": 1.4985,
        "val_bpc": 3.639
      },
      {
        "step": 3600,
        "train_loss": 0.9492,
        "val_loss": 2.5065,
        "train_bpc": 1.3694,
        "val_bpc": 3.6161
      },
      {
        "step": 3700,
        "train_loss": 0.9448,
        "val_loss": 2.4909,
        "train_bpc": 1.3631,
        "val_bpc": 3.5936
      },
      {
        "step": 3800,
        "train_loss": 1.0568,
        "val_loss": 2.5117,
        "train_bpc": 1.5247,
        "val_bpc": 3.6235
      },
      {
        "step": 3900,
        "train_loss": 0.9199,
        "val_loss": 2.5484,
        "train_bpc": 1.3272,
        "val_bpc": 3.6766
      },
      {
        "step": 4000,
        "train_loss": 0.9209,
        "val_loss": 2.5926,
        "train_bpc": 1.3286,
        "val_bpc": 3.7403
      },
      {
        "step": 4100,
        "train_loss": 1.0389,
        "val_loss": 2.5413,
        "train_bpc": 1.4988,
        "val_bpc": 3.6663
      },
      {
        "step": 4200,
        "train_loss": 0.8462,
        "val_loss": 2.5284,
        "train_bpc": 1.2209,
        "val_bpc": 3.6476
      },
      {
        "step": 4300,
        "train_loss": 1.0436,
        "val_loss": 2.5818,
        "train_bpc": 1.5056,
        "val_bpc": 3.7248
      },
      {
        "step": 4400,
        "train_loss": 1.0027,
        "val_loss": 2.6471,
        "train_bpc": 1.4465,
        "val_bpc": 3.819
      },
      {
        "step": 4500,
        "train_loss": 0.9749,
        "val_loss": 2.5757,
        "train_bpc": 1.4065,
        "val_bpc": 3.7159
      },
      {
        "step": 4600,
        "train_loss": 0.9092,
        "val_loss": 2.6011,
        "train_bpc": 1.3116,
        "val_bpc": 3.7526
      },
      {
        "step": 4700,
        "train_loss": 1.0251,
        "val_loss": 2.548,
        "train_bpc": 1.479,
        "val_bpc": 3.6761
      },
      {
        "step": 4800,
        "train_loss": 1.0433,
        "val_loss": 2.5802,
        "train_bpc": 1.5051,
        "val_bpc": 3.7224
      },
      {
        "step": 4900,
        "train_loss": 0.9488,
        "val_loss": 2.5854,
        "train_bpc": 1.3688,
        "val_bpc": 3.73
      },
      {
        "step": 5000,
        "train_loss": 0.8571,
        "val_loss": 2.6103,
        "train_bpc": 1.2366,
        "val_bpc": 3.7658
      },
      {
        "step": 5100,
        "train_loss": 1.0096,
        "val_loss": 2.6241,
        "train_bpc": 1.4566,
        "val_bpc": 3.7858
      },
      {
        "step": 5200,
        "train_loss": 1.0862,
        "val_loss": 2.5703,
        "train_bpc": 1.5671,
        "val_bpc": 3.7082
      },
      {
        "step": 5300,
        "train_loss": 0.8162,
        "val_loss": 2.5928,
        "train_bpc": 1.1776,
        "val_bpc": 3.7407
      },
      {
        "step": 5400,
        "train_loss": 1.0243,
        "val_loss": 2.6356,
        "train_bpc": 1.4777,
        "val_bpc": 3.8024
      },
      {
        "step": 5500,
        "train_loss": 0.8521,
        "val_loss": 2.6398,
        "train_bpc": 1.2293,
        "val_bpc": 3.8084
      },
      {
        "step": 5600,
        "train_loss": 0.8567,
        "val_loss": 2.615,
        "train_bpc": 1.236,
        "val_bpc": 3.7727
      },
      {
        "step": 5700,
        "train_loss": 1.011,
        "val_loss": 2.6267,
        "train_bpc": 1.4586,
        "val_bpc": 3.7896
      },
      {
        "step": 5800,
        "train_loss": 0.9918,
        "val_loss": 2.6034,
        "train_bpc": 1.4309,
        "val_bpc": 3.756
      },
      {
        "step": 5900,
        "train_loss": 0.9995,
        "val_loss": 2.6367,
        "train_bpc": 1.4419,
        "val_bpc": 3.8039
      },
      {
        "step": 6000,
        "train_loss": 0.972,
        "val_loss": 2.5943,
        "train_bpc": 1.4023,
        "val_bpc": 3.7428
      },
      {
        "step": 6100,
        "train_loss": 0.9345,
        "val_loss": 2.6454,
        "train_bpc": 1.3482,
        "val_bpc": 3.8165
      },
      {
        "step": 6200,
        "train_loss": 1.0037,
        "val_loss": 2.6503,
        "train_bpc": 1.448,
        "val_bpc": 3.8236
      },
      {
        "step": 6300,
        "train_loss": 1.1396,
        "val_loss": 2.6966,
        "train_bpc": 1.6442,
        "val_bpc": 3.8904
      },
      {
        "step": 6400,
        "train_loss": 0.7385,
        "val_loss": 2.7047,
        "train_bpc": 1.0654,
        "val_bpc": 3.902
      },
      {
        "step": 6500,
        "train_loss": 1.0318,
        "val_loss": 2.7217,
        "train_bpc": 1.4886,
        "val_bpc": 3.9265
      },
      {
        "step": 6600,
        "train_loss": 0.9746,
        "val_loss": 2.7115,
        "train_bpc": 1.4061,
        "val_bpc": 3.9118
      },
      {
        "step": 6700,
        "train_loss": 0.8268,
        "val_loss": 2.7243,
        "train_bpc": 1.1929,
        "val_bpc": 3.9303
      },
      {
        "step": 6800,
        "train_loss": 0.9097,
        "val_loss": 2.7435,
        "train_bpc": 1.3124,
        "val_bpc": 3.958
      },
      {
        "step": 6900,
        "train_loss": 0.8749,
        "val_loss": 2.6908,
        "train_bpc": 1.2622,
        "val_bpc": 3.882
      },
      {
        "step": 7000,
        "train_loss": 0.9722,
        "val_loss": 2.7067,
        "train_bpc": 1.4026,
        "val_bpc": 3.9049
      },
      {
        "step": 7100,
        "train_loss": 0.9165,
        "val_loss": 2.7045,
        "train_bpc": 1.3223,
        "val_bpc": 3.9017
      },
      {
        "step": 7200,
        "train_loss": 0.992,
        "val_loss": 2.7439,
        "train_bpc": 1.4311,
        "val_bpc": 3.9586
      },
      {
        "step": 7300,
        "train_loss": 0.8331,
        "val_loss": 2.7361,
        "train_bpc": 1.2019,
        "val_bpc": 3.9474
      },
      {
        "step": 7400,
        "train_loss": 0.9208,
        "val_loss": 2.7423,
        "train_bpc": 1.3285,
        "val_bpc": 3.9564
      },
      {
        "step": 7500,
        "train_loss": 0.9302,
        "val_loss": 2.7394,
        "train_bpc": 1.342,
        "val_bpc": 3.9522
      },
      {
        "step": 7600,
        "train_loss": 0.857,
        "val_loss": 2.762,
        "train_bpc": 1.2363,
        "val_bpc": 3.9848
      },
      {
        "step": 7700,
        "train_loss": 0.8967,
        "val_loss": 2.7357,
        "train_bpc": 1.2937,
        "val_bpc": 3.9467
      },
      {
        "step": 7800,
        "train_loss": 1.0242,
        "val_loss": 2.7427,
        "train_bpc": 1.4776,
        "val_bpc": 3.9569
      },
      {
        "step": 7900,
        "train_loss": 0.9821,
        "val_loss": 2.7349,
        "train_bpc": 1.4168,
        "val_bpc": 3.9456
      },
      {
        "step": 8000,
        "train_loss": 0.9158,
        "val_loss": 2.7556,
        "train_bpc": 1.3212,
        "val_bpc": 3.9754
      },
      {
        "step": 8100,
        "train_loss": 0.8397,
        "val_loss": 2.7425,
        "train_bpc": 1.2114,
        "val_bpc": 3.9566
      },
      {
        "step": 8200,
        "train_loss": 0.9612,
        "val_loss": 2.7582,
        "train_bpc": 1.3868,
        "val_bpc": 3.9792
      },
      {
        "step": 8300,
        "train_loss": 0.7008,
        "val_loss": 2.7652,
        "train_bpc": 1.0111,
        "val_bpc": 3.9893
      },
      {
        "step": 8400,
        "train_loss": 0.8407,
        "val_loss": 2.7605,
        "train_bpc": 1.2128,
        "val_bpc": 3.9826
      },
      {
        "step": 8500,
        "train_loss": 0.8581,
        "val_loss": 2.7384,
        "train_bpc": 1.238,
        "val_bpc": 3.9507
      },
      {
        "step": 8600,
        "train_loss": 0.9459,
        "val_loss": 2.7498,
        "train_bpc": 1.3646,
        "val_bpc": 3.9671
      },
      {
        "step": 8700,
        "train_loss": 1.0513,
        "val_loss": 2.756,
        "train_bpc": 1.5167,
        "val_bpc": 3.9761
      },
      {
        "step": 8800,
        "train_loss": 0.776,
        "val_loss": 2.7606,
        "train_bpc": 1.1196,
        "val_bpc": 3.9827
      },
      {
        "step": 8900,
        "train_loss": 0.9186,
        "val_loss": 2.7557,
        "train_bpc": 1.3252,
        "val_bpc": 3.9756
      },
      {
        "step": 9000,
        "train_loss": 0.9676,
        "val_loss": 2.7565,
        "train_bpc": 1.3959,
        "val_bpc": 3.9768
      },
      {
        "step": 9100,
        "train_loss": 0.8268,
        "val_loss": 2.7523,
        "train_bpc": 1.1928,
        "val_bpc": 3.9707
      },
      {
        "step": 9200,
        "train_loss": 0.7412,
        "val_loss": 2.7588,
        "train_bpc": 1.0693,
        "val_bpc": 3.98
      },
      {
        "step": 9300,
        "train_loss": 0.7922,
        "val_loss": 2.751,
        "train_bpc": 1.1429,
        "val_bpc": 3.9688
      },
      {
        "step": 9400,
        "train_loss": 0.7367,
        "val_loss": 2.7554,
        "train_bpc": 1.0629,
        "val_bpc": 3.9752
      },
      {
        "step": 9500,
        "train_loss": 0.9694,
        "val_loss": 2.7572,
        "train_bpc": 1.3986,
        "val_bpc": 3.9778
      },
      {
        "step": 9600,
        "train_loss": 0.8139,
        "val_loss": 2.7568,
        "train_bpc": 1.1743,
        "val_bpc": 3.9772
      },
      {
        "step": 9700,
        "train_loss": 1.2141,
        "val_loss": 2.755,
        "train_bpc": 1.7516,
        "val_bpc": 3.9747
      },
      {
        "step": 9800,
        "train_loss": 0.9667,
        "val_loss": 2.7556,
        "train_bpc": 1.3946,
        "val_bpc": 3.9755
      },
      {
        "step": 9900,
        "train_loss": 0.9235,
        "val_loss": 2.7563,
        "train_bpc": 1.3323,
        "val_bpc": 3.9765
      },
      {
        "step": 10000,
        "train_loss": 1.0519,
        "val_loss": 2.7562,
        "train_bpc": 1.5176,
        "val_bpc": 3.9764
      }
    ],
    "train_chars": {
      "narrative": 407194,
      "babi": 2627365,
      "total": 3034561
    }
  },
  "babi": {
    "test_seen": {
      "task01": {
        "accuracy": 0.08,
        "correct": 16,
        "total": 200
      },
      "task02": {
        "accuracy": 0.085,
        "correct": 17,
        "total": 200
      },
      "task03": {
        "accuracy": 0.12,
        "correct": 24,
        "total": 200
      },
      "task04": {
        "accuracy": 0.01,
        "correct": 2,
        "total": 200
      },
      "task05": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task06": {
        "accuracy": 0.285,
        "correct": 57,
        "total": 200
      },
      "task07": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task08": {
        "accuracy": 0.01,
        "correct": 2,
        "total": 200
      },
      "task09": {
        "accuracy": 0.085,
        "correct": 17,
        "total": 200
      },
      "task10": {
        "accuracy": 0.305,
        "correct": 61,
        "total": 200
      },
      "task11": {
        "accuracy": 0.09,
        "correct": 18,
        "total": 200
      },
      "task12": {
        "accuracy": 0.055,
        "correct": 11,
        "total": 200
      },
      "task13": {
        "accuracy": 0.09,
        "correct": 18,
        "total": 200
      },
      "task14": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task15": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task16": {
        "accuracy": 0.25,
        "correct": 50,
        "total": 200
      },
      "task17": {
        "accuracy": 0.365,
        "correct": 73,
        "total": 200
      },
      "task18": {
        "accuracy": 0.32,
        "correct": 64,
        "total": 200
      },
      "task19": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task20": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "overall": {
        "accuracy": 0.1075,
        "correct": 430,
        "total": 4000
      }
    },
    "test_unseen": {
      "task01": {
        "accuracy": 0.005,
        "correct": 1,
        "total": 200
      },
      "task02": {
        "accuracy": 0.02,
        "correct": 4,
        "total": 200
      },
      "task03": {
        "accuracy": 0.035,
        "correct": 7,
        "total": 200
      },
      "task04": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task05": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task06": {
        "accuracy": 0.485,
        "correct": 97,
        "total": 200
      },
      "task07": {
        "accuracy": 0.09,
        "correct": 18,
        "total": 200
      },
      "task08": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task09": {
        "accuracy": 0.36,
        "correct": 72,
        "total": 200
      },
      "task10": {
        "accuracy": 0.195,
        "correct": 39,
        "total": 200
      },
      "task11": {
        "accuracy": 0.01,
        "correct": 2,
        "total": 200
      },
      "task12": {
        "accuracy": 0.005,
        "correct": 1,
        "total": 200
      },
      "task13": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task14": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task15": {
        "accuracy": 0.01,
        "correct": 2,
        "total": 200
      },
      "task16": {
        "accuracy": 0.095,
        "correct": 19,
        "total": 200
      },
      "task17": {
        "accuracy": 0.03,
        "correct": 6,
        "total": 200
      },
      "task18": {
        "accuracy": 0.275,
        "correct": 55,
        "total": 200
      },
      "task19": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task20": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "overall": {
        "accuracy": 0.0808,
        "correct": 323,
        "total": 4000
      }
    }
  },
  "test_bpc": {
    "test_bpc": 2.4137,
    "test_chars_evaluated": 114064
  },
  "val_bpc": 3.1427,
  "memorization": {
    "n_memorized": 0,
    "n_novel": 50,
    "avg_lcs": 18.3,
    "threshold": 50
  },
  "grammar": {
    "total_sentences": 109,
    "parseable": 109,
    "grammaticality_rate": 1.0,
    "novel_only": true,
    "n_samples_evaluated": 50,
    "sample_errors": []
  },
  "structural": {
    "char_kl_divergence": 0.24563,
    "ngram_diversity_3": 0.0343,
    "ngram_diversity_4": 0.0633,
    "ngram_diversity_5": 0.092,
    "repetition_rate_10": 0.7382,
    "repetition_rate_20": 0.3873,
    "repetition_rate_50": 0.0015,
    "word_length_similarity": 0.8247
  }
}