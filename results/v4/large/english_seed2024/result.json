{
  "config": {
    "size": "large",
    "language": "english",
    "seed": 2024,
    "d_model": 128,
    "n_layer": 3,
    "n_head": 4,
    "dropout": 0.15,
    "ctx_len": 256,
    "batch_size": 64,
    "max_steps": 10000,
    "lr": 0.0003,
    "weight_decay": 0.1,
    "grad_clip": 1.0,
    "warmup_steps": 100,
    "patience": 10001,
    "eval_interval": 100,
    "num_samples": 50,
    "prompt_len": 32,
    "gen_len": 128,
    "temperature": 0.8,
    "top_k": 40,
    "lcs_threshold": 50
  },
  "training": {
    "n_params": 758912,
    "vocab_size": 1024,
    "total_time_s": 635.8,
    "total_steps": 10000,
    "best_step": 2700,
    "best_val_loss": 2.2355,
    "best_val_bpc": 3.2251,
    "final_train_loss": 1.2098,
    "early_stopped": false,
    "bpc_thresholds_reached": {},
    "log": [
      {
        "step": 1,
        "train_loss": 6.9238,
        "val_loss": 6.901,
        "train_bpc": 9.9889,
        "val_bpc": 9.956
      },
      {
        "step": 100,
        "train_loss": 4.5119,
        "val_loss": 4.1978,
        "train_bpc": 6.5093,
        "val_bpc": 6.0562
      },
      {
        "step": 200,
        "train_loss": 2.4412,
        "val_loss": 2.7309,
        "train_bpc": 3.5219,
        "val_bpc": 3.9398
      },
      {
        "step": 300,
        "train_loss": 2.3861,
        "val_loss": 2.5177,
        "train_bpc": 3.4424,
        "val_bpc": 3.6323
      },
      {
        "step": 400,
        "train_loss": 2.0899,
        "val_loss": 2.4758,
        "train_bpc": 3.0151,
        "val_bpc": 3.5719
      },
      {
        "step": 500,
        "train_loss": 1.9415,
        "val_loss": 2.4771,
        "train_bpc": 2.801,
        "val_bpc": 3.5737
      },
      {
        "step": 600,
        "train_loss": 2.0032,
        "val_loss": 2.4462,
        "train_bpc": 2.89,
        "val_bpc": 3.5291
      },
      {
        "step": 700,
        "train_loss": 1.8326,
        "val_loss": 2.3687,
        "train_bpc": 2.6439,
        "val_bpc": 3.4174
      },
      {
        "step": 800,
        "train_loss": 1.743,
        "val_loss": 2.2905,
        "train_bpc": 2.5146,
        "val_bpc": 3.3044
      },
      {
        "step": 900,
        "train_loss": 1.9844,
        "val_loss": 2.3345,
        "train_bpc": 2.8628,
        "val_bpc": 3.368
      },
      {
        "step": 1000,
        "train_loss": 1.7867,
        "val_loss": 2.3436,
        "train_bpc": 2.5776,
        "val_bpc": 3.3811
      },
      {
        "step": 1100,
        "train_loss": 1.7346,
        "val_loss": 2.3718,
        "train_bpc": 2.5024,
        "val_bpc": 3.4217
      },
      {
        "step": 1200,
        "train_loss": 1.2999,
        "val_loss": 2.3677,
        "train_bpc": 1.8754,
        "val_bpc": 3.4159
      },
      {
        "step": 1300,
        "train_loss": 1.6927,
        "val_loss": 2.3438,
        "train_bpc": 2.442,
        "val_bpc": 3.3814
      },
      {
        "step": 1400,
        "train_loss": 1.7539,
        "val_loss": 2.3869,
        "train_bpc": 2.5303,
        "val_bpc": 3.4435
      },
      {
        "step": 1500,
        "train_loss": 1.5629,
        "val_loss": 2.3544,
        "train_bpc": 2.2548,
        "val_bpc": 3.3966
      },
      {
        "step": 1600,
        "train_loss": 1.4609,
        "val_loss": 2.3371,
        "train_bpc": 2.1077,
        "val_bpc": 3.3718
      },
      {
        "step": 1700,
        "train_loss": 1.3767,
        "val_loss": 2.3614,
        "train_bpc": 1.9862,
        "val_bpc": 3.4068
      },
      {
        "step": 1800,
        "train_loss": 1.5238,
        "val_loss": 2.3244,
        "train_bpc": 2.1983,
        "val_bpc": 3.3534
      },
      {
        "step": 1900,
        "train_loss": 1.4565,
        "val_loss": 2.2604,
        "train_bpc": 2.1013,
        "val_bpc": 3.2611
      },
      {
        "step": 2000,
        "train_loss": 1.6755,
        "val_loss": 2.2513,
        "train_bpc": 2.4172,
        "val_bpc": 3.2479
      },
      {
        "step": 2100,
        "train_loss": 1.7771,
        "val_loss": 2.3442,
        "train_bpc": 2.5638,
        "val_bpc": 3.3819
      },
      {
        "step": 2200,
        "train_loss": 1.4028,
        "val_loss": 2.2756,
        "train_bpc": 2.0239,
        "val_bpc": 3.283
      },
      {
        "step": 2300,
        "train_loss": 1.6703,
        "val_loss": 2.2808,
        "train_bpc": 2.4097,
        "val_bpc": 3.2905
      },
      {
        "step": 2400,
        "train_loss": 1.6723,
        "val_loss": 2.3364,
        "train_bpc": 2.4126,
        "val_bpc": 3.3707
      },
      {
        "step": 2500,
        "train_loss": 2.0435,
        "val_loss": 2.3184,
        "train_bpc": 2.9482,
        "val_bpc": 3.3447
      },
      {
        "step": 2600,
        "train_loss": 1.3792,
        "val_loss": 2.3336,
        "train_bpc": 1.9898,
        "val_bpc": 3.3666
      },
      {
        "step": 2700,
        "train_loss": 1.5241,
        "val_loss": 2.2355,
        "train_bpc": 2.1988,
        "val_bpc": 3.2251
      },
      {
        "step": 2800,
        "train_loss": 1.6461,
        "val_loss": 2.3148,
        "train_bpc": 2.3748,
        "val_bpc": 3.3396
      },
      {
        "step": 2900,
        "train_loss": 1.5148,
        "val_loss": 2.3223,
        "train_bpc": 2.1853,
        "val_bpc": 3.3504
      },
      {
        "step": 3000,
        "train_loss": 1.5439,
        "val_loss": 2.3623,
        "train_bpc": 2.2274,
        "val_bpc": 3.4081
      },
      {
        "step": 3100,
        "train_loss": 1.6134,
        "val_loss": 2.2904,
        "train_bpc": 2.3276,
        "val_bpc": 3.3043
      },
      {
        "step": 3200,
        "train_loss": 1.5306,
        "val_loss": 2.4476,
        "train_bpc": 2.2082,
        "val_bpc": 3.5311
      },
      {
        "step": 3300,
        "train_loss": 1.53,
        "val_loss": 2.4558,
        "train_bpc": 2.2073,
        "val_bpc": 3.543
      },
      {
        "step": 3400,
        "train_loss": 1.6763,
        "val_loss": 2.4838,
        "train_bpc": 2.4185,
        "val_bpc": 3.5833
      },
      {
        "step": 3500,
        "train_loss": 1.4641,
        "val_loss": 2.4107,
        "train_bpc": 2.1123,
        "val_bpc": 3.4779
      },
      {
        "step": 3600,
        "train_loss": 1.452,
        "val_loss": 2.344,
        "train_bpc": 2.0947,
        "val_bpc": 3.3816
      },
      {
        "step": 3700,
        "train_loss": 1.6704,
        "val_loss": 2.3054,
        "train_bpc": 2.4099,
        "val_bpc": 3.326
      },
      {
        "step": 3800,
        "train_loss": 1.3511,
        "val_loss": 2.3993,
        "train_bpc": 1.9492,
        "val_bpc": 3.4615
      },
      {
        "step": 3900,
        "train_loss": 1.6588,
        "val_loss": 2.4437,
        "train_bpc": 2.3931,
        "val_bpc": 3.5256
      },
      {
        "step": 4000,
        "train_loss": 1.3822,
        "val_loss": 2.4339,
        "train_bpc": 1.9941,
        "val_bpc": 3.5114
      },
      {
        "step": 4100,
        "train_loss": 1.5346,
        "val_loss": 2.4142,
        "train_bpc": 2.2139,
        "val_bpc": 3.483
      },
      {
        "step": 4200,
        "train_loss": 1.3716,
        "val_loss": 2.4108,
        "train_bpc": 1.9788,
        "val_bpc": 3.478
      },
      {
        "step": 4300,
        "train_loss": 1.1652,
        "val_loss": 2.3339,
        "train_bpc": 1.681,
        "val_bpc": 3.3671
      },
      {
        "step": 4400,
        "train_loss": 1.41,
        "val_loss": 2.4075,
        "train_bpc": 2.0342,
        "val_bpc": 3.4734
      },
      {
        "step": 4500,
        "train_loss": 1.2281,
        "val_loss": 2.4486,
        "train_bpc": 1.7718,
        "val_bpc": 3.5326
      },
      {
        "step": 4600,
        "train_loss": 1.5897,
        "val_loss": 2.4592,
        "train_bpc": 2.2934,
        "val_bpc": 3.5478
      },
      {
        "step": 4700,
        "train_loss": 1.2181,
        "val_loss": 2.4446,
        "train_bpc": 1.7573,
        "val_bpc": 3.5268
      },
      {
        "step": 4800,
        "train_loss": 1.3831,
        "val_loss": 2.4612,
        "train_bpc": 1.9954,
        "val_bpc": 3.5508
      },
      {
        "step": 4900,
        "train_loss": 1.3625,
        "val_loss": 2.3911,
        "train_bpc": 1.9657,
        "val_bpc": 3.4496
      },
      {
        "step": 5000,
        "train_loss": 1.4731,
        "val_loss": 2.4246,
        "train_bpc": 2.1253,
        "val_bpc": 3.498
      },
      {
        "step": 5100,
        "train_loss": 1.327,
        "val_loss": 2.3882,
        "train_bpc": 1.9144,
        "val_bpc": 3.4454
      },
      {
        "step": 5200,
        "train_loss": 1.3004,
        "val_loss": 2.3964,
        "train_bpc": 1.8761,
        "val_bpc": 3.4573
      },
      {
        "step": 5300,
        "train_loss": 1.2165,
        "val_loss": 2.4751,
        "train_bpc": 1.755,
        "val_bpc": 3.5708
      },
      {
        "step": 5400,
        "train_loss": 1.2125,
        "val_loss": 2.396,
        "train_bpc": 1.7493,
        "val_bpc": 3.4567
      },
      {
        "step": 5500,
        "train_loss": 1.4945,
        "val_loss": 2.3817,
        "train_bpc": 2.1561,
        "val_bpc": 3.4361
      },
      {
        "step": 5600,
        "train_loss": 1.2813,
        "val_loss": 2.4485,
        "train_bpc": 1.8486,
        "val_bpc": 3.5324
      },
      {
        "step": 5700,
        "train_loss": 1.3572,
        "val_loss": 2.3998,
        "train_bpc": 1.9581,
        "val_bpc": 3.4621
      },
      {
        "step": 5800,
        "train_loss": 1.369,
        "val_loss": 2.4748,
        "train_bpc": 1.975,
        "val_bpc": 3.5704
      },
      {
        "step": 5900,
        "train_loss": 1.1863,
        "val_loss": 2.3974,
        "train_bpc": 1.7115,
        "val_bpc": 3.4587
      },
      {
        "step": 6000,
        "train_loss": 1.0806,
        "val_loss": 2.4448,
        "train_bpc": 1.5589,
        "val_bpc": 3.5271
      },
      {
        "step": 6100,
        "train_loss": 1.7616,
        "val_loss": 2.4805,
        "train_bpc": 2.5415,
        "val_bpc": 3.5785
      },
      {
        "step": 6200,
        "train_loss": 1.5963,
        "val_loss": 2.4717,
        "train_bpc": 2.3029,
        "val_bpc": 3.566
      },
      {
        "step": 6300,
        "train_loss": 1.2708,
        "val_loss": 2.3855,
        "train_bpc": 1.8334,
        "val_bpc": 3.4415
      },
      {
        "step": 6400,
        "train_loss": 1.2876,
        "val_loss": 2.4388,
        "train_bpc": 1.8576,
        "val_bpc": 3.5184
      },
      {
        "step": 6500,
        "train_loss": 1.5528,
        "val_loss": 2.4283,
        "train_bpc": 2.2402,
        "val_bpc": 3.5033
      },
      {
        "step": 6600,
        "train_loss": 1.4056,
        "val_loss": 2.4395,
        "train_bpc": 2.0278,
        "val_bpc": 3.5195
      },
      {
        "step": 6700,
        "train_loss": 1.2488,
        "val_loss": 2.4287,
        "train_bpc": 1.8016,
        "val_bpc": 3.5039
      },
      {
        "step": 6800,
        "train_loss": 1.3743,
        "val_loss": 2.4369,
        "train_bpc": 1.9828,
        "val_bpc": 3.5157
      },
      {
        "step": 6900,
        "train_loss": 1.2926,
        "val_loss": 2.4186,
        "train_bpc": 1.8649,
        "val_bpc": 3.4893
      },
      {
        "step": 7000,
        "train_loss": 1.3849,
        "val_loss": 2.4807,
        "train_bpc": 1.998,
        "val_bpc": 3.5789
      },
      {
        "step": 7100,
        "train_loss": 1.4782,
        "val_loss": 2.4941,
        "train_bpc": 2.1326,
        "val_bpc": 3.5982
      },
      {
        "step": 7200,
        "train_loss": 1.5345,
        "val_loss": 2.4061,
        "train_bpc": 2.2138,
        "val_bpc": 3.4712
      },
      {
        "step": 7300,
        "train_loss": 1.6314,
        "val_loss": 2.4722,
        "train_bpc": 2.3536,
        "val_bpc": 3.5666
      },
      {
        "step": 7400,
        "train_loss": 1.3003,
        "val_loss": 2.4588,
        "train_bpc": 1.876,
        "val_bpc": 3.5474
      },
      {
        "step": 7500,
        "train_loss": 1.1507,
        "val_loss": 2.4443,
        "train_bpc": 1.6602,
        "val_bpc": 3.5263
      },
      {
        "step": 7600,
        "train_loss": 1.8435,
        "val_loss": 2.47,
        "train_bpc": 2.6595,
        "val_bpc": 3.5634
      },
      {
        "step": 7700,
        "train_loss": 1.133,
        "val_loss": 2.4528,
        "train_bpc": 1.6346,
        "val_bpc": 3.5387
      },
      {
        "step": 7800,
        "train_loss": 1.1356,
        "val_loss": 2.4698,
        "train_bpc": 1.6383,
        "val_bpc": 3.5632
      },
      {
        "step": 7900,
        "train_loss": 1.3783,
        "val_loss": 2.4423,
        "train_bpc": 1.9884,
        "val_bpc": 3.5235
      },
      {
        "step": 8000,
        "train_loss": 1.4631,
        "val_loss": 2.4814,
        "train_bpc": 2.1109,
        "val_bpc": 3.5799
      },
      {
        "step": 8100,
        "train_loss": 1.2453,
        "val_loss": 2.4722,
        "train_bpc": 1.7966,
        "val_bpc": 3.5667
      },
      {
        "step": 8200,
        "train_loss": 1.0956,
        "val_loss": 2.4478,
        "train_bpc": 1.5806,
        "val_bpc": 3.5315
      },
      {
        "step": 8300,
        "train_loss": 1.4036,
        "val_loss": 2.4579,
        "train_bpc": 2.0249,
        "val_bpc": 3.546
      },
      {
        "step": 8400,
        "train_loss": 1.3528,
        "val_loss": 2.4429,
        "train_bpc": 1.9517,
        "val_bpc": 3.5244
      },
      {
        "step": 8500,
        "train_loss": 1.3824,
        "val_loss": 2.4437,
        "train_bpc": 1.9944,
        "val_bpc": 3.5255
      },
      {
        "step": 8600,
        "train_loss": 1.332,
        "val_loss": 2.452,
        "train_bpc": 1.9216,
        "val_bpc": 3.5375
      },
      {
        "step": 8700,
        "train_loss": 1.3529,
        "val_loss": 2.4598,
        "train_bpc": 1.9518,
        "val_bpc": 3.5487
      },
      {
        "step": 8800,
        "train_loss": 1.1717,
        "val_loss": 2.4577,
        "train_bpc": 1.6904,
        "val_bpc": 3.5457
      },
      {
        "step": 8900,
        "train_loss": 1.4949,
        "val_loss": 2.4484,
        "train_bpc": 2.1566,
        "val_bpc": 3.5323
      },
      {
        "step": 9000,
        "train_loss": 1.3447,
        "val_loss": 2.4727,
        "train_bpc": 1.94,
        "val_bpc": 3.5674
      },
      {
        "step": 9100,
        "train_loss": 1.144,
        "val_loss": 2.4548,
        "train_bpc": 1.6504,
        "val_bpc": 3.5416
      },
      {
        "step": 9200,
        "train_loss": 1.5495,
        "val_loss": 2.4507,
        "train_bpc": 2.2354,
        "val_bpc": 3.5356
      },
      {
        "step": 9300,
        "train_loss": 1.2216,
        "val_loss": 2.4546,
        "train_bpc": 1.7624,
        "val_bpc": 3.5412
      },
      {
        "step": 9400,
        "train_loss": 1.2732,
        "val_loss": 2.4515,
        "train_bpc": 1.8368,
        "val_bpc": 3.5368
      },
      {
        "step": 9500,
        "train_loss": 1.3171,
        "val_loss": 2.4559,
        "train_bpc": 1.9002,
        "val_bpc": 3.5431
      },
      {
        "step": 9600,
        "train_loss": 1.2351,
        "val_loss": 2.4587,
        "train_bpc": 1.7819,
        "val_bpc": 3.5472
      },
      {
        "step": 9700,
        "train_loss": 1.2109,
        "val_loss": 2.4576,
        "train_bpc": 1.747,
        "val_bpc": 3.5455
      },
      {
        "step": 9800,
        "train_loss": 1.202,
        "val_loss": 2.4582,
        "train_bpc": 1.7342,
        "val_bpc": 3.5465
      },
      {
        "step": 9900,
        "train_loss": 1.4017,
        "val_loss": 2.4579,
        "train_bpc": 2.0223,
        "val_bpc": 3.546
      },
      {
        "step": 10000,
        "train_loss": 1.2098,
        "val_loss": 2.4578,
        "train_bpc": 1.7454,
        "val_bpc": 3.5459
      }
    ],
    "train_chars": {
      "narrative": 407194,
      "babi": 2390610,
      "total": 2797806
    }
  },
  "babi": {
    "test_seen": {
      "task01": {
        "accuracy": 0.08,
        "correct": 16,
        "total": 200
      },
      "task02": {
        "accuracy": 0.09,
        "correct": 18,
        "total": 200
      },
      "task03": {
        "accuracy": 0.045,
        "correct": 9,
        "total": 200
      },
      "task04": {
        "accuracy": 0.08,
        "correct": 16,
        "total": 200
      },
      "task05": {
        "accuracy": 0.08,
        "correct": 16,
        "total": 200
      },
      "task06": {
        "accuracy": 0.495,
        "correct": 99,
        "total": 200
      },
      "task07": {
        "accuracy": 0.335,
        "correct": 67,
        "total": 200
      },
      "task08": {
        "accuracy": 0.02,
        "correct": 4,
        "total": 200
      },
      "task09": {
        "accuracy": 0.5,
        "correct": 100,
        "total": 200
      },
      "task10": {
        "accuracy": 0.335,
        "correct": 67,
        "total": 200
      },
      "task11": {
        "accuracy": 0.06,
        "correct": 12,
        "total": 200
      },
      "task12": {
        "accuracy": 0.085,
        "correct": 17,
        "total": 200
      },
      "task13": {
        "accuracy": 0.06,
        "correct": 12,
        "total": 200
      },
      "task14": {
        "accuracy": 0.075,
        "correct": 15,
        "total": 200
      },
      "task15": {
        "accuracy": 0.135,
        "correct": 27,
        "total": 200
      },
      "task16": {
        "accuracy": 0.38,
        "correct": 76,
        "total": 200
      },
      "task17": {
        "accuracy": 0.64,
        "correct": 128,
        "total": 200
      },
      "task18": {
        "accuracy": 0.68,
        "correct": 136,
        "total": 200
      },
      "task19": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task20": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "overall": {
        "accuracy": 0.2087,
        "correct": 835,
        "total": 4000
      }
    },
    "test_unseen": {
      "task01": {
        "accuracy": 0.095,
        "correct": 19,
        "total": 200
      },
      "task02": {
        "accuracy": 0.04,
        "correct": 8,
        "total": 200
      },
      "task03": {
        "accuracy": 0.075,
        "correct": 15,
        "total": 200
      },
      "task04": {
        "accuracy": 0.065,
        "correct": 13,
        "total": 200
      },
      "task05": {
        "accuracy": 0.065,
        "correct": 13,
        "total": 200
      },
      "task06": {
        "accuracy": 0.41,
        "correct": 82,
        "total": 200
      },
      "task07": {
        "accuracy": 0.465,
        "correct": 93,
        "total": 200
      },
      "task08": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task09": {
        "accuracy": 0.535,
        "correct": 107,
        "total": 200
      },
      "task10": {
        "accuracy": 0.305,
        "correct": 61,
        "total": 200
      },
      "task11": {
        "accuracy": 0.055,
        "correct": 11,
        "total": 200
      },
      "task12": {
        "accuracy": 0.045,
        "correct": 9,
        "total": 200
      },
      "task13": {
        "accuracy": 0.085,
        "correct": 17,
        "total": 200
      },
      "task14": {
        "accuracy": 0.035,
        "correct": 7,
        "total": 200
      },
      "task15": {
        "accuracy": 0.055,
        "correct": 11,
        "total": 200
      },
      "task16": {
        "accuracy": 0.135,
        "correct": 27,
        "total": 200
      },
      "task17": {
        "accuracy": 0.675,
        "correct": 135,
        "total": 200
      },
      "task18": {
        "accuracy": 0.635,
        "correct": 127,
        "total": 200
      },
      "task19": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task20": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "overall": {
        "accuracy": 0.1888,
        "correct": 755,
        "total": 4000
      }
    }
  },
  "test_bpc": {
    "test_bpc": 2.4117,
    "test_chars_evaluated": 120813
  },
  "val_bpc": 3.2251,
  "memorization": {
    "n_memorized": 0,
    "n_novel": 50,
    "avg_lcs": 17.1,
    "threshold": 50
  },
  "grammar": {
    "total_sentences": 871,
    "error_free": 859,
    "grammaticality_rate": 0.9862,
    "avg_grammar_errors": 0.0184,
    "novel_only": true,
    "n_samples_evaluated": 50
  },
  "structural": {
    "char_kl_divergence": 0.101161,
    "ngram_diversity_3": 0.0586,
    "ngram_diversity_4": 0.1078,
    "ngram_diversity_5": 0.1531,
    "repetition_rate_10": 0.6656,
    "repetition_rate_20": 0.3559,
    "repetition_rate_50": 0.0043,
    "word_length_similarity": 0.905
  }
}