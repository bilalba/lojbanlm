{
  "config": {
    "size": "medium",
    "language": "english",
    "seed": 42,
    "d_model": 96,
    "n_layer": 4,
    "n_head": 4,
    "dropout": 0.15,
    "ctx_len": 256,
    "batch_size": 64,
    "max_steps": 10000,
    "lr": 0.0003,
    "weight_decay": 0.1,
    "grad_clip": 1.0,
    "warmup_steps": 100,
    "patience": 10001,
    "eval_interval": 100,
    "num_samples": 50,
    "prompt_len": 32,
    "gen_len": 128,
    "temperature": 0.8,
    "top_k": 40,
    "lcs_threshold": 50
  },
  "training": {
    "n_params": 570432,
    "vocab_size": 1024,
    "total_time_s": 859.4,
    "total_steps": 10000,
    "best_step": 1000,
    "best_val_loss": 2.3898,
    "best_val_bpc": 3.4477,
    "final_train_loss": 1.4148,
    "early_stopped": false,
    "bpc_thresholds_reached": {},
    "log": [
      {
        "step": 1,
        "train_loss": 6.9572,
        "val_loss": 6.974,
        "train_bpc": 10.0371,
        "val_bpc": 10.0614
      },
      {
        "step": 100,
        "train_loss": 5.0666,
        "val_loss": 4.8222,
        "train_bpc": 7.3096,
        "val_bpc": 6.957
      },
      {
        "step": 200,
        "train_loss": 3.3605,
        "val_loss": 3.0392,
        "train_bpc": 4.8481,
        "val_bpc": 4.3847
      },
      {
        "step": 300,
        "train_loss": 2.4991,
        "val_loss": 2.6291,
        "train_bpc": 3.6054,
        "val_bpc": 3.7931
      },
      {
        "step": 400,
        "train_loss": 2.3118,
        "val_loss": 2.5723,
        "train_bpc": 3.3352,
        "val_bpc": 3.7111
      },
      {
        "step": 500,
        "train_loss": 1.7949,
        "val_loss": 2.5655,
        "train_bpc": 2.5895,
        "val_bpc": 3.7012
      },
      {
        "step": 600,
        "train_loss": 2.0763,
        "val_loss": 2.5905,
        "train_bpc": 2.9955,
        "val_bpc": 3.7373
      },
      {
        "step": 700,
        "train_loss": 2.1305,
        "val_loss": 2.4374,
        "train_bpc": 3.0737,
        "val_bpc": 3.5164
      },
      {
        "step": 800,
        "train_loss": 1.4017,
        "val_loss": 2.4498,
        "train_bpc": 2.0222,
        "val_bpc": 3.5343
      },
      {
        "step": 900,
        "train_loss": 1.9977,
        "val_loss": 2.3969,
        "train_bpc": 2.8821,
        "val_bpc": 3.458
      },
      {
        "step": 1000,
        "train_loss": 1.8881,
        "val_loss": 2.3898,
        "train_bpc": 2.724,
        "val_bpc": 3.4477
      },
      {
        "step": 1100,
        "train_loss": 1.5483,
        "val_loss": 2.4166,
        "train_bpc": 2.2337,
        "val_bpc": 3.4865
      },
      {
        "step": 1200,
        "train_loss": 1.9222,
        "val_loss": 2.433,
        "train_bpc": 2.7732,
        "val_bpc": 3.5101
      },
      {
        "step": 1300,
        "train_loss": 1.5158,
        "val_loss": 2.4952,
        "train_bpc": 2.1868,
        "val_bpc": 3.5999
      },
      {
        "step": 1400,
        "train_loss": 1.702,
        "val_loss": 2.5319,
        "train_bpc": 2.4555,
        "val_bpc": 3.6527
      },
      {
        "step": 1500,
        "train_loss": 1.4997,
        "val_loss": 2.547,
        "train_bpc": 2.1636,
        "val_bpc": 3.6745
      },
      {
        "step": 1600,
        "train_loss": 1.7988,
        "val_loss": 2.546,
        "train_bpc": 2.5951,
        "val_bpc": 3.6731
      },
      {
        "step": 1700,
        "train_loss": 1.3301,
        "val_loss": 2.604,
        "train_bpc": 1.919,
        "val_bpc": 3.7568
      },
      {
        "step": 1800,
        "train_loss": 1.6069,
        "val_loss": 2.5816,
        "train_bpc": 2.3183,
        "val_bpc": 3.7244
      },
      {
        "step": 1900,
        "train_loss": 1.388,
        "val_loss": 2.6172,
        "train_bpc": 2.0025,
        "val_bpc": 3.7758
      },
      {
        "step": 2000,
        "train_loss": 1.467,
        "val_loss": 2.6357,
        "train_bpc": 2.1165,
        "val_bpc": 3.8025
      },
      {
        "step": 2100,
        "train_loss": 1.6567,
        "val_loss": 2.5985,
        "train_bpc": 2.3901,
        "val_bpc": 3.7488
      },
      {
        "step": 2200,
        "train_loss": 1.4249,
        "val_loss": 2.6427,
        "train_bpc": 2.0557,
        "val_bpc": 3.8126
      },
      {
        "step": 2300,
        "train_loss": 1.6105,
        "val_loss": 2.6467,
        "train_bpc": 2.3235,
        "val_bpc": 3.8184
      },
      {
        "step": 2400,
        "train_loss": 1.5834,
        "val_loss": 2.6158,
        "train_bpc": 2.2844,
        "val_bpc": 3.7737
      },
      {
        "step": 2500,
        "train_loss": 1.7337,
        "val_loss": 2.6114,
        "train_bpc": 2.5012,
        "val_bpc": 3.7675
      },
      {
        "step": 2600,
        "train_loss": 1.5858,
        "val_loss": 2.7216,
        "train_bpc": 2.2878,
        "val_bpc": 3.9265
      },
      {
        "step": 2700,
        "train_loss": 1.3983,
        "val_loss": 2.6841,
        "train_bpc": 2.0173,
        "val_bpc": 3.8724
      },
      {
        "step": 2800,
        "train_loss": 1.6592,
        "val_loss": 2.6635,
        "train_bpc": 2.3938,
        "val_bpc": 3.8426
      },
      {
        "step": 2900,
        "train_loss": 1.8392,
        "val_loss": 2.6687,
        "train_bpc": 2.6534,
        "val_bpc": 3.8501
      },
      {
        "step": 3000,
        "train_loss": 1.4577,
        "val_loss": 2.7032,
        "train_bpc": 2.1031,
        "val_bpc": 3.8998
      },
      {
        "step": 3100,
        "train_loss": 1.508,
        "val_loss": 2.7606,
        "train_bpc": 2.1756,
        "val_bpc": 3.9826
      },
      {
        "step": 3200,
        "train_loss": 1.5995,
        "val_loss": 2.7429,
        "train_bpc": 2.3077,
        "val_bpc": 3.9571
      },
      {
        "step": 3300,
        "train_loss": 1.6042,
        "val_loss": 2.6995,
        "train_bpc": 2.3144,
        "val_bpc": 3.8946
      },
      {
        "step": 3400,
        "train_loss": 1.956,
        "val_loss": 2.7511,
        "train_bpc": 2.8219,
        "val_bpc": 3.969
      },
      {
        "step": 3500,
        "train_loss": 1.4705,
        "val_loss": 2.8383,
        "train_bpc": 2.1214,
        "val_bpc": 4.0948
      },
      {
        "step": 3600,
        "train_loss": 1.6731,
        "val_loss": 2.8202,
        "train_bpc": 2.4138,
        "val_bpc": 4.0686
      },
      {
        "step": 3700,
        "train_loss": 1.6691,
        "val_loss": 2.7509,
        "train_bpc": 2.408,
        "val_bpc": 3.9687
      },
      {
        "step": 3800,
        "train_loss": 1.4646,
        "val_loss": 2.8022,
        "train_bpc": 2.1129,
        "val_bpc": 4.0427
      },
      {
        "step": 3900,
        "train_loss": 1.3653,
        "val_loss": 2.8314,
        "train_bpc": 1.9697,
        "val_bpc": 4.0848
      },
      {
        "step": 4000,
        "train_loss": 1.5736,
        "val_loss": 2.8595,
        "train_bpc": 2.2702,
        "val_bpc": 4.1254
      },
      {
        "step": 4100,
        "train_loss": 1.5953,
        "val_loss": 2.8806,
        "train_bpc": 2.3015,
        "val_bpc": 4.1559
      },
      {
        "step": 4200,
        "train_loss": 1.3814,
        "val_loss": 2.8667,
        "train_bpc": 1.9929,
        "val_bpc": 4.1358
      },
      {
        "step": 4300,
        "train_loss": 1.694,
        "val_loss": 2.9099,
        "train_bpc": 2.444,
        "val_bpc": 4.1981
      },
      {
        "step": 4400,
        "train_loss": 1.5714,
        "val_loss": 2.8472,
        "train_bpc": 2.267,
        "val_bpc": 4.1077
      },
      {
        "step": 4500,
        "train_loss": 1.2698,
        "val_loss": 2.8399,
        "train_bpc": 1.832,
        "val_bpc": 4.0971
      },
      {
        "step": 4600,
        "train_loss": 1.5045,
        "val_loss": 2.829,
        "train_bpc": 2.1706,
        "val_bpc": 4.0814
      },
      {
        "step": 4700,
        "train_loss": 1.5978,
        "val_loss": 2.8538,
        "train_bpc": 2.3051,
        "val_bpc": 4.1171
      },
      {
        "step": 4800,
        "train_loss": 1.7047,
        "val_loss": 2.9094,
        "train_bpc": 2.4594,
        "val_bpc": 4.1973
      },
      {
        "step": 4900,
        "train_loss": 1.462,
        "val_loss": 2.9016,
        "train_bpc": 2.1092,
        "val_bpc": 4.1861
      },
      {
        "step": 5000,
        "train_loss": 1.7595,
        "val_loss": 2.8731,
        "train_bpc": 2.5385,
        "val_bpc": 4.145
      },
      {
        "step": 5100,
        "train_loss": 1.511,
        "val_loss": 2.8795,
        "train_bpc": 2.1799,
        "val_bpc": 4.1543
      },
      {
        "step": 5200,
        "train_loss": 1.5439,
        "val_loss": 2.9107,
        "train_bpc": 2.2273,
        "val_bpc": 4.1992
      },
      {
        "step": 5300,
        "train_loss": 1.3539,
        "val_loss": 2.8841,
        "train_bpc": 1.9533,
        "val_bpc": 4.1609
      },
      {
        "step": 5400,
        "train_loss": 1.7971,
        "val_loss": 2.8605,
        "train_bpc": 2.5927,
        "val_bpc": 4.1268
      },
      {
        "step": 5500,
        "train_loss": 1.5544,
        "val_loss": 2.8884,
        "train_bpc": 2.2425,
        "val_bpc": 4.1671
      },
      {
        "step": 5600,
        "train_loss": 1.5115,
        "val_loss": 2.8945,
        "train_bpc": 2.1806,
        "val_bpc": 4.1758
      },
      {
        "step": 5700,
        "train_loss": 1.5268,
        "val_loss": 2.9253,
        "train_bpc": 2.2028,
        "val_bpc": 4.2203
      },
      {
        "step": 5800,
        "train_loss": 1.5613,
        "val_loss": 2.9467,
        "train_bpc": 2.2524,
        "val_bpc": 4.2511
      },
      {
        "step": 5900,
        "train_loss": 1.5412,
        "val_loss": 2.891,
        "train_bpc": 2.2234,
        "val_bpc": 4.1709
      },
      {
        "step": 6000,
        "train_loss": 1.2243,
        "val_loss": 2.9082,
        "train_bpc": 1.7663,
        "val_bpc": 4.1957
      },
      {
        "step": 6100,
        "train_loss": 1.5668,
        "val_loss": 2.9026,
        "train_bpc": 2.2604,
        "val_bpc": 4.1876
      },
      {
        "step": 6200,
        "train_loss": 1.4782,
        "val_loss": 2.9029,
        "train_bpc": 2.1325,
        "val_bpc": 4.1879
      },
      {
        "step": 6300,
        "train_loss": 1.4584,
        "val_loss": 2.9052,
        "train_bpc": 2.104,
        "val_bpc": 4.1913
      },
      {
        "step": 6400,
        "train_loss": 1.2555,
        "val_loss": 2.929,
        "train_bpc": 1.8113,
        "val_bpc": 4.2256
      },
      {
        "step": 6500,
        "train_loss": 1.4074,
        "val_loss": 2.9086,
        "train_bpc": 2.0305,
        "val_bpc": 4.1962
      },
      {
        "step": 6600,
        "train_loss": 1.4942,
        "val_loss": 2.9151,
        "train_bpc": 2.1557,
        "val_bpc": 4.2056
      },
      {
        "step": 6700,
        "train_loss": 1.5125,
        "val_loss": 2.9529,
        "train_bpc": 2.182,
        "val_bpc": 4.2601
      },
      {
        "step": 6800,
        "train_loss": 1.3512,
        "val_loss": 2.9024,
        "train_bpc": 1.9494,
        "val_bpc": 4.1873
      },
      {
        "step": 6900,
        "train_loss": 1.466,
        "val_loss": 2.9415,
        "train_bpc": 2.1149,
        "val_bpc": 4.2436
      },
      {
        "step": 7000,
        "train_loss": 1.5365,
        "val_loss": 2.9141,
        "train_bpc": 2.2168,
        "val_bpc": 4.2041
      },
      {
        "step": 7100,
        "train_loss": 1.4411,
        "val_loss": 2.9038,
        "train_bpc": 2.079,
        "val_bpc": 4.1893
      },
      {
        "step": 7200,
        "train_loss": 1.4163,
        "val_loss": 2.8986,
        "train_bpc": 2.0434,
        "val_bpc": 4.1819
      },
      {
        "step": 7300,
        "train_loss": 1.7394,
        "val_loss": 2.9484,
        "train_bpc": 2.5095,
        "val_bpc": 4.2536
      },
      {
        "step": 7400,
        "train_loss": 1.4068,
        "val_loss": 2.9349,
        "train_bpc": 2.0295,
        "val_bpc": 4.2342
      },
      {
        "step": 7500,
        "train_loss": 1.3684,
        "val_loss": 2.9296,
        "train_bpc": 1.9741,
        "val_bpc": 4.2265
      },
      {
        "step": 7600,
        "train_loss": 1.3916,
        "val_loss": 2.9419,
        "train_bpc": 2.0076,
        "val_bpc": 4.2443
      },
      {
        "step": 7700,
        "train_loss": 1.7976,
        "val_loss": 2.9452,
        "train_bpc": 2.5934,
        "val_bpc": 4.249
      },
      {
        "step": 7800,
        "train_loss": 1.1653,
        "val_loss": 2.9442,
        "train_bpc": 1.6811,
        "val_bpc": 4.2476
      },
      {
        "step": 7900,
        "train_loss": 1.3527,
        "val_loss": 2.9661,
        "train_bpc": 1.9515,
        "val_bpc": 4.2791
      },
      {
        "step": 8000,
        "train_loss": 1.4566,
        "val_loss": 2.9616,
        "train_bpc": 2.1014,
        "val_bpc": 4.2726
      },
      {
        "step": 8100,
        "train_loss": 1.7438,
        "val_loss": 2.9823,
        "train_bpc": 2.5158,
        "val_bpc": 4.3025
      },
      {
        "step": 8200,
        "train_loss": 1.2298,
        "val_loss": 2.9572,
        "train_bpc": 1.7743,
        "val_bpc": 4.2663
      },
      {
        "step": 8300,
        "train_loss": 1.2667,
        "val_loss": 2.952,
        "train_bpc": 1.8274,
        "val_bpc": 4.2588
      },
      {
        "step": 8400,
        "train_loss": 1.5485,
        "val_loss": 2.9711,
        "train_bpc": 2.234,
        "val_bpc": 4.2865
      },
      {
        "step": 8500,
        "train_loss": 1.1366,
        "val_loss": 2.9551,
        "train_bpc": 1.6398,
        "val_bpc": 4.2634
      },
      {
        "step": 8600,
        "train_loss": 1.3757,
        "val_loss": 2.9715,
        "train_bpc": 1.9847,
        "val_bpc": 4.2869
      },
      {
        "step": 8700,
        "train_loss": 1.4643,
        "val_loss": 2.9617,
        "train_bpc": 2.1126,
        "val_bpc": 4.2729
      },
      {
        "step": 8800,
        "train_loss": 1.3146,
        "val_loss": 2.9684,
        "train_bpc": 1.8966,
        "val_bpc": 4.2825
      },
      {
        "step": 8900,
        "train_loss": 1.5138,
        "val_loss": 2.96,
        "train_bpc": 2.184,
        "val_bpc": 4.2704
      },
      {
        "step": 9000,
        "train_loss": 1.2611,
        "val_loss": 2.9716,
        "train_bpc": 1.8194,
        "val_bpc": 4.2872
      },
      {
        "step": 9100,
        "train_loss": 1.664,
        "val_loss": 2.9684,
        "train_bpc": 2.4007,
        "val_bpc": 4.2825
      },
      {
        "step": 9200,
        "train_loss": 1.287,
        "val_loss": 2.9691,
        "train_bpc": 1.8568,
        "val_bpc": 4.2835
      },
      {
        "step": 9300,
        "train_loss": 1.5132,
        "val_loss": 2.9657,
        "train_bpc": 2.183,
        "val_bpc": 4.2786
      },
      {
        "step": 9400,
        "train_loss": 1.4738,
        "val_loss": 2.9684,
        "train_bpc": 2.1263,
        "val_bpc": 4.2825
      },
      {
        "step": 9500,
        "train_loss": 1.2756,
        "val_loss": 2.9678,
        "train_bpc": 1.8404,
        "val_bpc": 4.2816
      },
      {
        "step": 9600,
        "train_loss": 1.3269,
        "val_loss": 2.9684,
        "train_bpc": 1.9143,
        "val_bpc": 4.2825
      },
      {
        "step": 9700,
        "train_loss": 1.2684,
        "val_loss": 2.9678,
        "train_bpc": 1.83,
        "val_bpc": 4.2817
      },
      {
        "step": 9800,
        "train_loss": 1.5977,
        "val_loss": 2.967,
        "train_bpc": 2.305,
        "val_bpc": 4.2805
      },
      {
        "step": 9900,
        "train_loss": 1.6775,
        "val_loss": 2.9677,
        "train_bpc": 2.4201,
        "val_bpc": 4.2815
      },
      {
        "step": 10000,
        "train_loss": 1.4148,
        "val_loss": 2.9677,
        "train_bpc": 2.0412,
        "val_bpc": 4.2815
      }
    ],
    "train_chars": {
      "narrative": 407194,
      "babi": 2390610,
      "total": 2797806
    }
  },
  "babi": {
    "test_seen": {
      "task01": {
        "accuracy": 0.075,
        "correct": 15,
        "total": 200
      },
      "task02": {
        "accuracy": 0.11,
        "correct": 22,
        "total": 200
      },
      "task03": {
        "accuracy": 0.07,
        "correct": 14,
        "total": 200
      },
      "task04": {
        "accuracy": 0.12,
        "correct": 24,
        "total": 200
      },
      "task05": {
        "accuracy": 0.065,
        "correct": 13,
        "total": 200
      },
      "task06": {
        "accuracy": 0.495,
        "correct": 99,
        "total": 200
      },
      "task07": {
        "accuracy": 0.41,
        "correct": 82,
        "total": 200
      },
      "task08": {
        "accuracy": 0.02,
        "correct": 4,
        "total": 200
      },
      "task09": {
        "accuracy": 0.495,
        "correct": 99,
        "total": 200
      },
      "task10": {
        "accuracy": 0.365,
        "correct": 73,
        "total": 200
      },
      "task11": {
        "accuracy": 0.11,
        "correct": 22,
        "total": 200
      },
      "task12": {
        "accuracy": 0.095,
        "correct": 19,
        "total": 200
      },
      "task13": {
        "accuracy": 0.075,
        "correct": 15,
        "total": 200
      },
      "task14": {
        "accuracy": 0.085,
        "correct": 17,
        "total": 200
      },
      "task15": {
        "accuracy": 0.12,
        "correct": 24,
        "total": 200
      },
      "task16": {
        "accuracy": 0.255,
        "correct": 51,
        "total": 200
      },
      "task17": {
        "accuracy": 0.64,
        "correct": 128,
        "total": 200
      },
      "task18": {
        "accuracy": 0.68,
        "correct": 136,
        "total": 200
      },
      "task19": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task20": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "overall": {
        "accuracy": 0.2142,
        "correct": 857,
        "total": 4000
      }
    },
    "test_unseen": {
      "task01": {
        "accuracy": 0.04,
        "correct": 8,
        "total": 200
      },
      "task02": {
        "accuracy": 0.035,
        "correct": 7,
        "total": 200
      },
      "task03": {
        "accuracy": 0.05,
        "correct": 10,
        "total": 200
      },
      "task04": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task05": {
        "accuracy": 0.01,
        "correct": 2,
        "total": 200
      },
      "task06": {
        "accuracy": 0.5,
        "correct": 100,
        "total": 200
      },
      "task07": {
        "accuracy": 0.175,
        "correct": 35,
        "total": 200
      },
      "task08": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task09": {
        "accuracy": 0.46,
        "correct": 92,
        "total": 200
      },
      "task10": {
        "accuracy": 0.27,
        "correct": 54,
        "total": 200
      },
      "task11": {
        "accuracy": 0.035,
        "correct": 7,
        "total": 200
      },
      "task12": {
        "accuracy": 0.005,
        "correct": 1,
        "total": 200
      },
      "task13": {
        "accuracy": 0.03,
        "correct": 6,
        "total": 200
      },
      "task14": {
        "accuracy": 0.04,
        "correct": 8,
        "total": 200
      },
      "task15": {
        "accuracy": 0.06,
        "correct": 12,
        "total": 200
      },
      "task16": {
        "accuracy": 0.06,
        "correct": 12,
        "total": 200
      },
      "task17": {
        "accuracy": 0.46,
        "correct": 92,
        "total": 200
      },
      "task18": {
        "accuracy": 0.58,
        "correct": 116,
        "total": 200
      },
      "task19": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task20": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "overall": {
        "accuracy": 0.1405,
        "correct": 562,
        "total": 4000
      }
    }
  },
  "test_bpc": {
    "test_bpc": 2.646,
    "test_chars_evaluated": 120813
  },
  "val_bpc": 3.4477,
  "memorization": {
    "n_memorized": 0,
    "n_novel": 50,
    "avg_lcs": 16.7,
    "threshold": 50
  },
  "grammar": {
    "total_sentences": 830,
    "error_free": 827,
    "grammaticality_rate": 0.9964,
    "avg_grammar_errors": 0.0036,
    "novel_only": true,
    "n_samples_evaluated": 50
  },
  "structural": {
    "char_kl_divergence": 0.09344,
    "ngram_diversity_3": 0.0612,
    "ngram_diversity_4": 0.1104,
    "ngram_diversity_5": 0.1542,
    "repetition_rate_10": 0.6422,
    "repetition_rate_20": 0.2826,
    "repetition_rate_50": 0.0013,
    "word_length_similarity": 0.9038
  }
}