{
  "config": {
    "size": "medium",
    "language": "english",
    "seed": 137,
    "d_model": 96,
    "n_layer": 4,
    "n_head": 4,
    "dropout": 0.15,
    "ctx_len": 256,
    "batch_size": 64,
    "max_steps": 10000,
    "lr": 0.0003,
    "weight_decay": 0.1,
    "grad_clip": 1.0,
    "warmup_steps": 100,
    "patience": 10001,
    "eval_interval": 100,
    "num_samples": 50,
    "prompt_len": 32,
    "gen_len": 128,
    "temperature": 0.8,
    "top_k": 40,
    "lcs_threshold": 50
  },
  "training": {
    "n_params": 570432,
    "vocab_size": 1024,
    "total_time_s": 856.2,
    "total_steps": 10000,
    "best_step": 1000,
    "best_val_loss": 2.4721,
    "best_val_bpc": 3.5664,
    "final_train_loss": 1.3848,
    "early_stopped": false,
    "bpc_thresholds_reached": {},
    "log": [
      {
        "step": 1,
        "train_loss": 6.9568,
        "val_loss": 6.9669,
        "train_bpc": 10.0365,
        "val_bpc": 10.0511
      },
      {
        "step": 100,
        "train_loss": 4.9685,
        "val_loss": 4.7451,
        "train_bpc": 7.1681,
        "val_bpc": 6.8458
      },
      {
        "step": 200,
        "train_loss": 3.368,
        "val_loss": 3.0354,
        "train_bpc": 4.8589,
        "val_bpc": 4.3792
      },
      {
        "step": 300,
        "train_loss": 2.7213,
        "val_loss": 2.5827,
        "train_bpc": 3.926,
        "val_bpc": 3.7261
      },
      {
        "step": 400,
        "train_loss": 2.2387,
        "val_loss": 2.5251,
        "train_bpc": 3.2297,
        "val_bpc": 3.6429
      },
      {
        "step": 500,
        "train_loss": 2.4701,
        "val_loss": 2.5386,
        "train_bpc": 3.5636,
        "val_bpc": 3.6624
      },
      {
        "step": 600,
        "train_loss": 1.8285,
        "val_loss": 2.6118,
        "train_bpc": 2.6379,
        "val_bpc": 3.768
      },
      {
        "step": 700,
        "train_loss": 1.88,
        "val_loss": 2.5639,
        "train_bpc": 2.7123,
        "val_bpc": 3.699
      },
      {
        "step": 800,
        "train_loss": 2.1233,
        "val_loss": 2.518,
        "train_bpc": 3.0633,
        "val_bpc": 3.6327
      },
      {
        "step": 900,
        "train_loss": 1.7988,
        "val_loss": 2.5111,
        "train_bpc": 2.5952,
        "val_bpc": 3.6228
      },
      {
        "step": 1000,
        "train_loss": 1.7481,
        "val_loss": 2.4721,
        "train_bpc": 2.522,
        "val_bpc": 3.5664
      },
      {
        "step": 1100,
        "train_loss": 1.8348,
        "val_loss": 2.5717,
        "train_bpc": 2.647,
        "val_bpc": 3.7101
      },
      {
        "step": 1200,
        "train_loss": 1.7166,
        "val_loss": 2.5663,
        "train_bpc": 2.4765,
        "val_bpc": 3.7023
      },
      {
        "step": 1300,
        "train_loss": 1.37,
        "val_loss": 2.58,
        "train_bpc": 1.9765,
        "val_bpc": 3.7222
      },
      {
        "step": 1400,
        "train_loss": 1.5298,
        "val_loss": 2.6162,
        "train_bpc": 2.207,
        "val_bpc": 3.7744
      },
      {
        "step": 1500,
        "train_loss": 1.8625,
        "val_loss": 2.5957,
        "train_bpc": 2.687,
        "val_bpc": 3.7449
      },
      {
        "step": 1600,
        "train_loss": 1.6241,
        "val_loss": 2.5862,
        "train_bpc": 2.3431,
        "val_bpc": 3.7311
      },
      {
        "step": 1700,
        "train_loss": 1.7636,
        "val_loss": 2.6359,
        "train_bpc": 2.5443,
        "val_bpc": 3.8028
      },
      {
        "step": 1800,
        "train_loss": 1.798,
        "val_loss": 2.6484,
        "train_bpc": 2.594,
        "val_bpc": 3.8208
      },
      {
        "step": 1900,
        "train_loss": 1.5765,
        "val_loss": 2.6199,
        "train_bpc": 2.2744,
        "val_bpc": 3.7798
      },
      {
        "step": 2000,
        "train_loss": 1.7443,
        "val_loss": 2.6545,
        "train_bpc": 2.5165,
        "val_bpc": 3.8296
      },
      {
        "step": 2100,
        "train_loss": 1.2172,
        "val_loss": 2.654,
        "train_bpc": 1.7561,
        "val_bpc": 3.8289
      },
      {
        "step": 2200,
        "train_loss": 1.9789,
        "val_loss": 2.6571,
        "train_bpc": 2.8549,
        "val_bpc": 3.8334
      },
      {
        "step": 2300,
        "train_loss": 1.3877,
        "val_loss": 2.675,
        "train_bpc": 2.0021,
        "val_bpc": 3.8593
      },
      {
        "step": 2400,
        "train_loss": 1.366,
        "val_loss": 2.7392,
        "train_bpc": 1.9707,
        "val_bpc": 3.9518
      },
      {
        "step": 2500,
        "train_loss": 1.7028,
        "val_loss": 2.727,
        "train_bpc": 2.4566,
        "val_bpc": 3.9342
      },
      {
        "step": 2600,
        "train_loss": 1.7021,
        "val_loss": 2.6872,
        "train_bpc": 2.4556,
        "val_bpc": 3.8768
      },
      {
        "step": 2700,
        "train_loss": 1.7664,
        "val_loss": 2.7252,
        "train_bpc": 2.5484,
        "val_bpc": 3.9316
      },
      {
        "step": 2800,
        "train_loss": 1.6754,
        "val_loss": 2.6902,
        "train_bpc": 2.4171,
        "val_bpc": 3.8811
      },
      {
        "step": 2900,
        "train_loss": 1.3722,
        "val_loss": 2.7091,
        "train_bpc": 1.9796,
        "val_bpc": 3.9084
      },
      {
        "step": 3000,
        "train_loss": 1.4453,
        "val_loss": 2.6886,
        "train_bpc": 2.0851,
        "val_bpc": 3.8788
      },
      {
        "step": 3100,
        "train_loss": 1.5124,
        "val_loss": 2.673,
        "train_bpc": 2.1819,
        "val_bpc": 3.8564
      },
      {
        "step": 3200,
        "train_loss": 1.7364,
        "val_loss": 2.7332,
        "train_bpc": 2.5051,
        "val_bpc": 3.9432
      },
      {
        "step": 3300,
        "train_loss": 1.5357,
        "val_loss": 2.6996,
        "train_bpc": 2.2155,
        "val_bpc": 3.8947
      },
      {
        "step": 3400,
        "train_loss": 1.5275,
        "val_loss": 2.7268,
        "train_bpc": 2.2037,
        "val_bpc": 3.9339
      },
      {
        "step": 3500,
        "train_loss": 1.5287,
        "val_loss": 2.7402,
        "train_bpc": 2.2055,
        "val_bpc": 3.9533
      },
      {
        "step": 3600,
        "train_loss": 1.4257,
        "val_loss": 2.7283,
        "train_bpc": 2.0568,
        "val_bpc": 3.9361
      },
      {
        "step": 3700,
        "train_loss": 1.7805,
        "val_loss": 2.7466,
        "train_bpc": 2.5687,
        "val_bpc": 3.9624
      },
      {
        "step": 3800,
        "train_loss": 1.6198,
        "val_loss": 2.7644,
        "train_bpc": 2.3369,
        "val_bpc": 3.9882
      },
      {
        "step": 3900,
        "train_loss": 1.6301,
        "val_loss": 2.7767,
        "train_bpc": 2.3518,
        "val_bpc": 4.006
      },
      {
        "step": 4000,
        "train_loss": 1.4388,
        "val_loss": 2.6812,
        "train_bpc": 2.0757,
        "val_bpc": 3.8682
      },
      {
        "step": 4100,
        "train_loss": 1.586,
        "val_loss": 2.7824,
        "train_bpc": 2.2882,
        "val_bpc": 4.0142
      },
      {
        "step": 4200,
        "train_loss": 1.7523,
        "val_loss": 2.7568,
        "train_bpc": 2.528,
        "val_bpc": 3.9773
      },
      {
        "step": 4300,
        "train_loss": 1.462,
        "val_loss": 2.7014,
        "train_bpc": 2.1092,
        "val_bpc": 3.8973
      },
      {
        "step": 4400,
        "train_loss": 1.4078,
        "val_loss": 2.7553,
        "train_bpc": 2.031,
        "val_bpc": 3.9751
      },
      {
        "step": 4500,
        "train_loss": 1.2531,
        "val_loss": 2.8505,
        "train_bpc": 1.8078,
        "val_bpc": 4.1124
      },
      {
        "step": 4600,
        "train_loss": 1.431,
        "val_loss": 2.8289,
        "train_bpc": 2.0645,
        "val_bpc": 4.0812
      },
      {
        "step": 4700,
        "train_loss": 1.6494,
        "val_loss": 2.8267,
        "train_bpc": 2.3796,
        "val_bpc": 4.0781
      },
      {
        "step": 4800,
        "train_loss": 1.443,
        "val_loss": 2.81,
        "train_bpc": 2.0818,
        "val_bpc": 4.054
      },
      {
        "step": 4900,
        "train_loss": 1.3286,
        "val_loss": 2.773,
        "train_bpc": 1.9168,
        "val_bpc": 4.0006
      },
      {
        "step": 5000,
        "train_loss": 1.3214,
        "val_loss": 2.7722,
        "train_bpc": 1.9064,
        "val_bpc": 3.9995
      },
      {
        "step": 5100,
        "train_loss": 1.8817,
        "val_loss": 2.8,
        "train_bpc": 2.7147,
        "val_bpc": 4.0395
      },
      {
        "step": 5200,
        "train_loss": 1.6361,
        "val_loss": 2.8069,
        "train_bpc": 2.3604,
        "val_bpc": 4.0495
      },
      {
        "step": 5300,
        "train_loss": 1.5202,
        "val_loss": 2.793,
        "train_bpc": 2.1931,
        "val_bpc": 4.0295
      },
      {
        "step": 5400,
        "train_loss": 1.4577,
        "val_loss": 2.8122,
        "train_bpc": 2.1031,
        "val_bpc": 4.0571
      },
      {
        "step": 5500,
        "train_loss": 1.4176,
        "val_loss": 2.8031,
        "train_bpc": 2.0452,
        "val_bpc": 4.044
      },
      {
        "step": 5600,
        "train_loss": 1.316,
        "val_loss": 2.7817,
        "train_bpc": 1.8986,
        "val_bpc": 4.0132
      },
      {
        "step": 5700,
        "train_loss": 1.5904,
        "val_loss": 2.847,
        "train_bpc": 2.2944,
        "val_bpc": 4.1074
      },
      {
        "step": 5800,
        "train_loss": 1.5932,
        "val_loss": 2.7926,
        "train_bpc": 2.2985,
        "val_bpc": 4.0288
      },
      {
        "step": 5900,
        "train_loss": 1.3394,
        "val_loss": 2.8607,
        "train_bpc": 1.9324,
        "val_bpc": 4.1272
      },
      {
        "step": 6000,
        "train_loss": 1.4517,
        "val_loss": 2.868,
        "train_bpc": 2.0944,
        "val_bpc": 4.1377
      },
      {
        "step": 6100,
        "train_loss": 1.713,
        "val_loss": 2.8974,
        "train_bpc": 2.4713,
        "val_bpc": 4.18
      },
      {
        "step": 6200,
        "train_loss": 1.383,
        "val_loss": 2.9003,
        "train_bpc": 1.9953,
        "val_bpc": 4.1842
      },
      {
        "step": 6300,
        "train_loss": 1.3554,
        "val_loss": 2.8896,
        "train_bpc": 1.9554,
        "val_bpc": 4.1688
      },
      {
        "step": 6400,
        "train_loss": 1.6239,
        "val_loss": 2.8865,
        "train_bpc": 2.3428,
        "val_bpc": 4.1644
      },
      {
        "step": 6500,
        "train_loss": 1.3735,
        "val_loss": 2.8413,
        "train_bpc": 1.9815,
        "val_bpc": 4.0992
      },
      {
        "step": 6600,
        "train_loss": 1.1843,
        "val_loss": 2.8562,
        "train_bpc": 1.7085,
        "val_bpc": 4.1206
      },
      {
        "step": 6700,
        "train_loss": 1.3093,
        "val_loss": 2.8397,
        "train_bpc": 1.8889,
        "val_bpc": 4.0968
      },
      {
        "step": 6800,
        "train_loss": 1.4276,
        "val_loss": 2.8404,
        "train_bpc": 2.0596,
        "val_bpc": 4.0978
      },
      {
        "step": 6900,
        "train_loss": 1.1411,
        "val_loss": 2.8682,
        "train_bpc": 1.6462,
        "val_bpc": 4.1379
      },
      {
        "step": 7000,
        "train_loss": 1.5716,
        "val_loss": 2.8379,
        "train_bpc": 2.2673,
        "val_bpc": 4.0942
      },
      {
        "step": 7100,
        "train_loss": 1.3305,
        "val_loss": 2.8568,
        "train_bpc": 1.9195,
        "val_bpc": 4.1215
      },
      {
        "step": 7200,
        "train_loss": 1.4075,
        "val_loss": 2.8498,
        "train_bpc": 2.0307,
        "val_bpc": 4.1114
      },
      {
        "step": 7300,
        "train_loss": 1.8345,
        "val_loss": 2.8635,
        "train_bpc": 2.6466,
        "val_bpc": 4.1312
      },
      {
        "step": 7400,
        "train_loss": 1.5189,
        "val_loss": 2.9268,
        "train_bpc": 2.1912,
        "val_bpc": 4.2225
      },
      {
        "step": 7500,
        "train_loss": 1.2582,
        "val_loss": 2.8692,
        "train_bpc": 1.8152,
        "val_bpc": 4.1393
      },
      {
        "step": 7600,
        "train_loss": 1.3673,
        "val_loss": 2.8936,
        "train_bpc": 1.9726,
        "val_bpc": 4.1746
      },
      {
        "step": 7700,
        "train_loss": 1.3055,
        "val_loss": 2.8809,
        "train_bpc": 1.8835,
        "val_bpc": 4.1563
      },
      {
        "step": 7800,
        "train_loss": 1.4541,
        "val_loss": 2.8823,
        "train_bpc": 2.0978,
        "val_bpc": 4.1582
      },
      {
        "step": 7900,
        "train_loss": 1.577,
        "val_loss": 2.8915,
        "train_bpc": 2.2752,
        "val_bpc": 4.1715
      },
      {
        "step": 8000,
        "train_loss": 1.6703,
        "val_loss": 2.8851,
        "train_bpc": 2.4098,
        "val_bpc": 4.1623
      },
      {
        "step": 8100,
        "train_loss": 1.5888,
        "val_loss": 2.8856,
        "train_bpc": 2.2921,
        "val_bpc": 4.163
      },
      {
        "step": 8200,
        "train_loss": 1.24,
        "val_loss": 2.8924,
        "train_bpc": 1.7889,
        "val_bpc": 4.1729
      },
      {
        "step": 8300,
        "train_loss": 1.619,
        "val_loss": 2.8757,
        "train_bpc": 2.3358,
        "val_bpc": 4.1487
      },
      {
        "step": 8400,
        "train_loss": 1.3426,
        "val_loss": 2.879,
        "train_bpc": 1.937,
        "val_bpc": 4.1536
      },
      {
        "step": 8500,
        "train_loss": 1.1266,
        "val_loss": 2.8898,
        "train_bpc": 1.6254,
        "val_bpc": 4.1691
      },
      {
        "step": 8600,
        "train_loss": 1.2586,
        "val_loss": 2.8915,
        "train_bpc": 1.8157,
        "val_bpc": 4.1715
      },
      {
        "step": 8700,
        "train_loss": 1.1207,
        "val_loss": 2.9091,
        "train_bpc": 1.6169,
        "val_bpc": 4.1969
      },
      {
        "step": 8800,
        "train_loss": 1.1768,
        "val_loss": 2.9031,
        "train_bpc": 1.6977,
        "val_bpc": 4.1883
      },
      {
        "step": 8900,
        "train_loss": 1.2817,
        "val_loss": 2.8997,
        "train_bpc": 1.8491,
        "val_bpc": 4.1834
      },
      {
        "step": 9000,
        "train_loss": 1.4679,
        "val_loss": 2.904,
        "train_bpc": 2.1178,
        "val_bpc": 4.1895
      },
      {
        "step": 9100,
        "train_loss": 1.4828,
        "val_loss": 2.909,
        "train_bpc": 2.1393,
        "val_bpc": 4.1968
      },
      {
        "step": 9200,
        "train_loss": 1.3492,
        "val_loss": 2.9047,
        "train_bpc": 1.9464,
        "val_bpc": 4.1906
      },
      {
        "step": 9300,
        "train_loss": 1.4644,
        "val_loss": 2.9049,
        "train_bpc": 2.1127,
        "val_bpc": 4.1909
      },
      {
        "step": 9400,
        "train_loss": 1.3046,
        "val_loss": 2.9066,
        "train_bpc": 1.8822,
        "val_bpc": 4.1933
      },
      {
        "step": 9500,
        "train_loss": 1.3085,
        "val_loss": 2.9096,
        "train_bpc": 1.8877,
        "val_bpc": 4.1976
      },
      {
        "step": 9600,
        "train_loss": 1.3121,
        "val_loss": 2.909,
        "train_bpc": 1.8929,
        "val_bpc": 4.1969
      },
      {
        "step": 9700,
        "train_loss": 1.4332,
        "val_loss": 2.9085,
        "train_bpc": 2.0677,
        "val_bpc": 4.1961
      },
      {
        "step": 9800,
        "train_loss": 1.2138,
        "val_loss": 2.9098,
        "train_bpc": 1.7512,
        "val_bpc": 4.198
      },
      {
        "step": 9900,
        "train_loss": 1.7582,
        "val_loss": 2.9101,
        "train_bpc": 2.5366,
        "val_bpc": 4.1984
      },
      {
        "step": 10000,
        "train_loss": 1.3848,
        "val_loss": 2.9101,
        "train_bpc": 1.9978,
        "val_bpc": 4.1985
      }
    ],
    "train_chars": {
      "narrative": 407194,
      "babi": 2390610,
      "total": 2797806
    }
  },
  "babi": {
    "test_seen": {
      "task01": {
        "accuracy": 0.01,
        "correct": 2,
        "total": 200
      },
      "task02": {
        "accuracy": 0.095,
        "correct": 19,
        "total": 200
      },
      "task03": {
        "accuracy": 0.07,
        "correct": 14,
        "total": 200
      },
      "task04": {
        "accuracy": 0.07,
        "correct": 14,
        "total": 200
      },
      "task05": {
        "accuracy": 0.07,
        "correct": 14,
        "total": 200
      },
      "task06": {
        "accuracy": 0.5,
        "correct": 100,
        "total": 200
      },
      "task07": {
        "accuracy": 0.41,
        "correct": 82,
        "total": 200
      },
      "task08": {
        "accuracy": 0.015,
        "correct": 3,
        "total": 200
      },
      "task09": {
        "accuracy": 0.475,
        "correct": 95,
        "total": 200
      },
      "task10": {
        "accuracy": 0.3,
        "correct": 60,
        "total": 200
      },
      "task11": {
        "accuracy": 0.07,
        "correct": 14,
        "total": 200
      },
      "task12": {
        "accuracy": 0.095,
        "correct": 19,
        "total": 200
      },
      "task13": {
        "accuracy": 0.11,
        "correct": 22,
        "total": 200
      },
      "task14": {
        "accuracy": 0.11,
        "correct": 22,
        "total": 200
      },
      "task15": {
        "accuracy": 0.12,
        "correct": 24,
        "total": 200
      },
      "task16": {
        "accuracy": 0.235,
        "correct": 47,
        "total": 200
      },
      "task17": {
        "accuracy": 0.64,
        "correct": 128,
        "total": 200
      },
      "task18": {
        "accuracy": 0.68,
        "correct": 136,
        "total": 200
      },
      "task19": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task20": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "overall": {
        "accuracy": 0.2037,
        "correct": 815,
        "total": 4000
      }
    },
    "test_unseen": {
      "task01": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task02": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task03": {
        "accuracy": 0.005,
        "correct": 1,
        "total": 200
      },
      "task04": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task05": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task06": {
        "accuracy": 0.57,
        "correct": 114,
        "total": 200
      },
      "task07": {
        "accuracy": 0.27,
        "correct": 54,
        "total": 200
      },
      "task08": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task09": {
        "accuracy": 0.495,
        "correct": 99,
        "total": 200
      },
      "task10": {
        "accuracy": 0.395,
        "correct": 79,
        "total": 200
      },
      "task11": {
        "accuracy": 0.005,
        "correct": 1,
        "total": 200
      },
      "task12": {
        "accuracy": 0.005,
        "correct": 1,
        "total": 200
      },
      "task13": {
        "accuracy": 0.02,
        "correct": 4,
        "total": 200
      },
      "task14": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task15": {
        "accuracy": 0.09,
        "correct": 18,
        "total": 200
      },
      "task16": {
        "accuracy": 0.12,
        "correct": 24,
        "total": 200
      },
      "task17": {
        "accuracy": 0.6,
        "correct": 120,
        "total": 200
      },
      "task18": {
        "accuracy": 0.595,
        "correct": 119,
        "total": 200
      },
      "task19": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "task20": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 200
      },
      "overall": {
        "accuracy": 0.1585,
        "correct": 634,
        "total": 4000
      }
    }
  },
  "test_bpc": {
    "test_bpc": 2.6538,
    "test_chars_evaluated": 120813
  },
  "val_bpc": 3.5664,
  "memorization": {
    "n_memorized": 0,
    "n_novel": 50,
    "avg_lcs": 16.5,
    "threshold": 50
  },
  "grammar": {
    "total_sentences": 812,
    "error_free": 802,
    "grammaticality_rate": 0.9877,
    "avg_grammar_errors": 0.0148,
    "novel_only": true,
    "n_samples_evaluated": 50
  },
  "structural": {
    "char_kl_divergence": 0.085152,
    "ngram_diversity_3": 0.0606,
    "ngram_diversity_4": 0.109,
    "ngram_diversity_5": 0.1531,
    "repetition_rate_10": 0.6483,
    "repetition_rate_20": 0.3123,
    "repetition_rate_50": 0.0037,
    "word_length_similarity": 0.8895
  }
}